!function(){"use strict";var t="undefined"==typeof global?self:global;if("function"!=typeof t.require){var e={},r={},n={},i={}.hasOwnProperty,o=/^\.\.?(\/|$)/,a=function(t,e){for(var r,n=[],i=(o.test(e)?t+"/"+e:e).split("/"),a=0,s=i.length;a<s;a++)".."===(r=i[a])?n.pop():"."!==r&&""!==r&&n.push(r);return n.join("/")},s=function(t){return t.split("/").slice(0,-1).join("/")},c=function(e,n){var i,o={id:e,exports:{},hot:p&&p.createHot(e)};return r[e]=o,n(o.exports,(i=e,function(e){var r=a(s(i),e);return t.require(r,i)}),o),o.exports},u=function(t){var e=n[t];return e&&t!==e?u(e):t},l=function(t,n){null==n&&(n="/");var o=u(t);if(i.call(r,o))return r[o].exports;if(i.call(e,o))return c(o,e[o]);throw new Error("Cannot find module '"+t+"' from '"+n+"'")};l.alias=function(t,e){n[e]=t};var f=/\.[^.\/]+$/,h=/\/index(\.[^\/]+)?$/;l.register=l.define=function(t,o){if(t&&"object"==typeof t)for(var a in t)i.call(t,a)&&l.register(a,t[a]);else e[t]=o,delete r[t],function(t){if(f.test(t)){var e=t.replace(f,"");i.call(n,e)&&n[e].replace(f,"")!==e+"/index"||(n[e]=t)}if(h.test(t)){var r=t.replace(h,"");i.call(n,r)||(n[r]=t)}}(t)},l.list=function(){var t=[];for(var r in e)i.call(e,r)&&t.push(r);return t};var p=t._hmr&&new t._hmr(function(t,e){return u(a(s(t),e))},l,e,r);l._cache=r,l.hmr=p&&p.wrap,l.brunch=!0,t.require=l}}(),function(){"undefined"==typeof window||window;var t=function(t,e,r){var n={},i=function(e,r){try{return t(r+"/node_modules/"+e)}catch(t){if(-1===t.toString().indexOf("Cannot find module"))throw t;if(-1!==r.indexOf("node_modules")){var o=r.split("/"),a=o.lastIndexOf("node_modules"),s=o.slice(0,a).join("/");return i(e,s)}}return n};return function(o){if(o in e&&(o=e[o]),o){if("."!==o[0]&&r){var a=i(o,r);if(a!==n)return a}return t(o)}}};require.register("curvature/base/Bag.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Bag=void 0;var t=r("./Bindable");function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.meta=Symbol("meta"),this.content=new Map,this.list=t.Bindable.makeBindable([]),this.current=0,this.type=void 0,this.changeCallback=r}var r,i,o;return r=e,(i=[{key:"has",value:function(t){return this.content.has(t)}},{key:"add",value:function(t){if(void 0===t||!(t instanceof Object))throw new Error("Only objects may be added to Bags.");if(this.type&&!(t instanceof this.type))throw console.error(this.type,t),new Error("Only objects of type ".concat(this.type," may be added to this Bag."));if(!this.content.has(t)){var r,n=(r=this.current++,Number(r));this.content.set(t,n),this.list[n]=t,this.changeCallback&&this.changeCallback(t,this.meta,e.ITEM_ADDED,n)}}},{key:"remove",value:function(t){if(void 0===t||!(t instanceof Object))throw new Error("Only objects may be removed from Bags.");if(this.type&&!(t instanceof this.type))throw console.error(this.type,t),new Error("Only objects of type ".concat(this.type," may be removed from this Bag."));if(!this.content.has(t))return this.changeCallback&&this.changeCallback(t,this.meta,0,void 0),!1;var r=this.content.get(t);return delete this.list[r],this.content.delete(t),this.changeCallback&&this.changeCallback(t,this.meta,e.ITEM_REMOVED,r),t}},{key:"items",value:function(){return Array.from(this.content.entries()).map(function(t){return t[0]})}}])&&n(r.prototype,i),o&&n(r,o),e}();e.Bag=i,Object.defineProperty(i,"ITEM_ADDED",{configurable:!1,enumerable:!1,writable:!0,value:1}),Object.defineProperty(i,"ITEM_REMOVED",{configurable:!1,enumerable:!1,writable:!0,value:-1})}()}),require.register("curvature/base/Bindable.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e,n,i){return(t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(e,"__esModule",{value:!0}),e.Bindable=void 0;var c=Symbol("ref"),u=Symbol("original"),l=Symbol("deck"),f=Symbol("binding"),h=Symbol("subBinding"),p=Symbol("bindingAll"),d=Symbol("isBindable"),g=Symbol("wrapping"),y=Symbol("executing"),v=Symbol("stack"),b=(Symbol("object"),Symbol("wrapped")),m=Symbol("unwrapped"),w=Symbol("getProto"),S=Symbol("onGet"),O=Symbol("onAllGet"),k=Symbol("bindChain"),A=Object.getPrototypeOf(Int8Array),x=window||{},_=[x.Node,x.File,x.Map,x.Set,x.WeakMap,x.WeakSet,x.ArrayBuffer,x.ResizeObserver,x.MutationObserver,x.PerformanceObserver,x.IntersectionObserver].filter(function(t){return"function"==typeof t}),P=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,i,s;return r=e,s=[{key:"isBindable",value:function(t){return!(!t||!t[d])&&t[d]===e}},{key:"onDeck",value:function(t,e){return t[l][e]||!1}},{key:"ref",value:function(t){return t[c]||!1}},{key:"makeBindable",value:function(t){return this.make(t)}},{key:"shuck",value:function(t,r){r=r||new Map;var n={};if(t instanceof A||t instanceof ArrayBuffer){var i=t.slice(0);return r.set(t,i),i}var a=Object.keys(t);for(var s in a){var c=a[s];if("___"!==c.substring(0,3)){var l=r.get(t[c]);if(l)n[c]=l;else if(t[c]!==t){if(t[c]&&"object"===o(t[c])){var f=t[c];e.isBindable(t[c])&&(f=t[c][u]),n[c]=this.shuck(f,r)}else n[c]=t[c];r.set(t[c],n[c])}else r.set(t[c],n),n[c]=n}}return e.isBindable(t)&&(delete n.bindTo,delete n.isBound),n}},{key:"make",value:function(r){var i=this;if(!r||!["function","object"].includes(o(r)))return r;if(_.filter(function(t){return r instanceof t}).length||Object.isSealed(r)||!Object.isExtensible(r))return r;if(r[c])return r[c];if(r[f])return r;Object.defineProperty(r,c,{configurable:!0,enumerable:!1,writable:!0,value:r}),Object.defineProperty(r,u,{configurable:!1,enumerable:!1,writable:!1,value:r}),Object.defineProperty(r,l,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,f,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,h,{configurable:!1,enumerable:!1,writable:!1,value:new Map}),Object.defineProperty(r,p,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,d,{configurable:!1,enumerable:!1,writable:!1,value:e}),Object.defineProperty(r,y,{enumerable:!1,writable:!0}),Object.defineProperty(r,g,{enumerable:!1,writable:!0}),Object.defineProperty(r,v,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,"___before___",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,"___after___",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,b,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,m,{configurable:!1,enumerable:!1,writable:!1,value:{}});Object.defineProperty(r,"bindTo",{configurable:!1,enumerable:!1,writable:!1,value:function t(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=!1;if(Array.isArray(n)){var u=n.map(function(e){return t(e,a,s)});return function(){return u.map(function(t){return t()})}}if(n instanceof Function&&(s=a||{},a=n,c=!0),s.delay>=0&&(a=i.wrapDelayCallback(a,s.delay)),s.throttle>=0&&(a=i.wrapThrottleCallback(a,s.throttle)),s.wait>=0&&(a=i.wrapWaitCallback(a,s.wait)),s.frame&&(a=i.wrapFrameCallback(a,s.frame)),s.idle&&(a=i.wrapIdleCallback(a)),c){var l=r[p].length;if(r[p].push(a),!("now"in s)||s.now)for(var d in r)a(r[d],d,r,!1);return function(){delete r[p][l]}}r[f][n]||(r[f][n]=[]);var g=r[f][n].length;if(s.children){var y=a;a=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=n[0],c=r[h].get(y);if(c&&(r[h].delete(y),c()),"object"===o(a)){var u=e.make(a);e.isBindable(u)&&r[h].set(y,u.bindTo(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return y.apply(void 0,n.concat(e))},Object.assign({},s,{children:!1}))),y.apply(void 0,n)}else y.apply(void 0,n)}}r[f][n].push(a),"now"in s&&!s.now||a(r[n],n,r,!1);var v=!1,b=function(){var t=r[h].get(a);t&&(r[h].delete(a),t()),v||(v=!0,r[f][n]&&delete r[f][n][g])};return s.removeWith&&s.removeWith instanceof View&&s.removeWith.onRemove(function(){return b}),b}});Object.defineProperty(r,k,{configurable:!1,enumerable:!1,writable:!1,value:function(t,e){var n=t.split("."),o=n.shift(),a=n.slice(0),s=[];return s.push(r.bindTo(o,function(t,r,n,o){var c=a.join(".");0!==a.length?(void 0===t&&(t=n[r]=i.makeBindable({})),s=s.concat(t[k](c,e))):e(t,r,n,o)})),function(){return s.map(function(t){return t()})}}}),Object.defineProperty(r,"___before",{configurable:!1,enumerable:!1,writable:!1,value:function(t){var e=r.___before___.length;r.___before___.push(t);var n=!1;return function(){n||(n=!0,delete r.___before___[e])}}}),Object.defineProperty(r,"___after",{configurable:!1,enumerable:!1,writable:!1,value:function(t){var e=r.___after___.length;r.___after___.push(t);var n=!1;return function(){n||(n=!0,delete r.___after___[e])}}});Object.defineProperty(r,"isBound",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var t in r[p])if(r[p][t])return!0;for(var e in r[f])for(var n in r[f][e])if(r[f][e][n])return!0;return!1}});var a=function(t){r[t]&&r[t]instanceof Object&&!r[t]instanceof Promise&&(_.filter(function(e){return r[t]instanceof e}).length||!Object.isExtensible(r[t])||Object.isSealed(r[t])||(r[t]=e.make(r[t])))};for(var s in r)a(s);return Object.defineProperty(r,c,{configurable:!1,enumerable:!1,writable:!1,value:new Proxy(r,{get:function(n,i){if(i===c||i===u||"apply"===i||"isBound"===i||"bindTo"===i||"__proto__"===i)return n[i];var o=Object.getOwnPropertyDescriptor(r,i);return!o||o.configurable||o.writable?r[O]?r[O](i):!r[S]||i in r?n[b][i]?n[b][i]:!o||o.configurable||o.writable?"function"==typeof n[i]?(Object.defineProperty(n[m],i,{configurable:!1,enumerable:!1,writable:!1,value:n[i]}),n[b][i]=e.make(function(){var e,o=r instanceof Promise||r instanceof Map||r instanceof Set||r instanceof WeakMap||r instanceof WeakSet||"function"==typeof Date&&r instanceof Date||"function"==typeof A&&r instanceof A||"function"==typeof ArrayBuffer&&r instanceof ArrayBuffer||"function"==typeof EventTarget&&r instanceof EventTarget||"function"==typeof ResizeObserver&&r instanceof ResizeObserver||"function"==typeof MutationObserver&&r instanceof MutationObserver||"function"==typeof PerformanceObserver&&r instanceof PerformanceObserver||"function"==typeof IntersectionObserver&&r instanceof IntersectionObserver?r:r[c];n[y]=i,n[v].unshift(i);for(var a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];for(var l in n.___before___)n.___before___[l](n,i,n[v],r,s);for(var f in e=new.target?t(n[m][i],s):Object.getPrototypeOf(n)[i]===n[i]?n[i].apply(o||r,s):n[i].apply(n,s),n.___after___)n.___after___[f](n,i,n[v],r,s);return n[y]=null,n[v].shift(),e}),n[b][i]):n[i]:(n[b][i]=n[i],n[b][i]):r[S](i):n[i]},set:function(t,n,i){if(n===u)return!0;if(void 0!==r[l][n]&&r[l][n]===i)return!0;if("string"==typeof n&&"___"===n.substring(0,3)&&"___"===n.slice(-3))return!0;if(t[n]===i)return!0;for(var o in i&&i instanceof Object&&(_.filter(function(t){return r instanceof t}).length||!Object.isExtensible(r)||Object.isSealed(r)||(i=e.makeBindable(i))),r[l][n]=i,r[p])r[p][o]&&r[p][o](i,n,t,!1);var a=!1;if(n in r[f])for(var s in r[f][n])r[f][n]&&r[f][n][s]&&!1===r[f][n][s](i,n,t,!1,t[n])&&(a=!0);if(delete r[l][n],!a){var c=Object.getOwnPropertyDescriptor(t,n);t instanceof File&&"lastModifiedDate"==n||c&&!c.writable||t[n]!==i||(t[n]=i)}var h=Reflect.set(t,n,i);if(Array.isArray(t)&&r[f].length)for(var d in r[f].length)(0,r[f].length[d])(t.length,"length",t,!1,t.length);return h},construct:function(r,i){var o="constructor";for(var a in r.___before___)r.___before___[a](r,o,r[v],void 0,i);var s=e.make(t(r[u],n(i)));for(var c in r.___after___)r.___after___[c](r,o,r[v],s,i);return s},getPrototypeOf:function(t){return w in r?r[w]:Reflect.getPrototypeOf(t)},deleteProperty:function(t,e){if(!(e in t))return!0;for(var n in r[p])r[p][n](void 0,e,t,!0,t[e]);if(e in r[f])for(var i in r[f][e])r[f][e][i]&&r[f][e][i](void 0,e,t,!0,t[e]);return delete t[e],!0}})}),r[c]}},{key:"clearBindings",value:function(t){var e;(e=function(t){return Object.keys(t).map(function(e){return delete t[e]})},function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.map(e)})(t[b],t[f],t[p],t.___after___,t.___before___)}},{key:"resolve",value:function(t,e){for(var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.split("."),o=i[0];i.length;){if(n&&1===i.length)return[this.makeBindable(t),i.shift(),o];!(!(r=i.shift())in t)&&t[r]&&t[r]instanceof Object||(t[r]={}),t=this.makeBindable(t[r])}return[this.makeBindable(t),r,o]}},{key:"wrapDelayCallback",value:function(t,e){return function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return setTimeout(function(){return t.apply(void 0,n)},e)}}},{key:"wrapThrottleCallback",value:function(t,e){var r=this;return this.throttles.set(t,!1),function(){r.throttles.get(t,!0)||(t.apply(void 0,arguments),r.throttles.set(t,!0),setTimeout(function(){r.throttles.set(t,!1)},e))}}},{key:"wrapWaitCallback",value:function(t,e){var r=this;return function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var a;(a=r.waiters.get(t))&&(r.waiters.delete(t),clearTimeout(a)),a=setTimeout(function(){return t.apply(void 0,i)},e),r.waiters.set(t,a)}}},{key:"wrapFrameCallback",value:function(t,e){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];requestAnimationFrame(function(){return t.apply(void 0,r)})}}},{key:"wrapIdleCallback",value:function(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];(window.requestIdleCallback||requestAnimationFrame)(function(){return t.apply(void 0,r)})}}}],(i=null)&&a(r.prototype,i),s&&a(r,s),e}();e.Bindable=P,s(P,"waiters",new WeakMap),s(P,"throttles",new WeakMap),Object.defineProperty(P,"OnGet",{configurable:!1,enumerable:!1,writable:!1,value:S}),Object.defineProperty(P,"GetProto",{configurable:!1,enumerable:!1,writable:!1,value:w}),Object.defineProperty(P,"OnAllGet",{configurable:!1,enumerable:!1,writable:!1,value:O})}()}),require.register("curvature/base/Cache.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Cache=void 0;var r=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"store",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard",i=0;r&&(i=1e3*r+(new Date).getTime()),this.bucket||(this.bucket={}),this.bucket[n]||(this.bucket[n]={}),this.bucket[n][t]={expiration:i,value:e}}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"standard";return this.bucket&&this.bucket[r]&&this.bucket[r][t]&&(0==this.bucket[r][t].expiration||this.bucket[r][t].expiration>(new Date).getTime())?this.bucket[r][t].value:e}}],(n=null)&&t(r.prototype,n),i&&t(r,i),e}();e.Cache=r}()}),require.register("curvature/base/Config.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;var n={};try{n=r("/Config").Config||{}}catch(t){!0===window.devMode&&console.error(t)}var i=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"get",value:function(t){return this.configs[t]}},{key:"set",value:function(t,e){return this.configs[t]=e,this}},{key:"dump",value:function(){return this.configs}},{key:"init",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n in e){var i=e[n];for(var o in"string"==typeof i&&(i=JSON.parse(i)),i){var a=i[o];return this.configs[o]=a}}return this}}],(n=null)&&t(r.prototype,n),i&&t(r,i),e}();e.Config=i,Object.defineProperty(i,"configs",{configurable:!1,enumerable:!1,writable:!1,value:n})}()}),require.register("curvature/base/Dom.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Dom=void 0;var r=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"mapTags",value:function(t,e,r,n,i){var o=[],a=!0;n&&(a=!1);var s=!1,c=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:function(t,r){if(!a){if(t!==n)return NodeFilter.FILTER_SKIP;a=!0}return i&&t===i&&(s=!0),s?NodeFilter.FILTER_SKIP:e?t instanceof Element&&t.matches(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}},!1);for(0;c.nextNode();)o.push(r(c.currentNode,c));return o}},{key:"dispatchEvent",value:function(t,r){t.dispatchEvent(r),e.mapTags(t,!1,function(t){t.dispatchEvent(r)})}}],(n=null)&&t(r.prototype,n),i&&t(r,i),e}();e.Dom=r}()}),require.register("curvature/base/Mixin.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mixin=void 0;var t=r("./Bindable");function n(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t){"@babel/helpers - typeof";return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=a(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=h(t);if(e){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var g=Symbol("constructor"),y=(Symbol("mixinList"),function(){function e(){p(this,e)}var r,a,s;return r=e,s=[{key:"from",value:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return function(r){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,t);var a=u(s);function s(){var t;p(this,s);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];var h,d=t=a.call.apply(a,[this].concat(c)),g=o(n);try{for(g.s();!(h=g.n()).done;){var y=h.value;switch(y[e.Constructor]&&y[e.Constructor].apply(f(t)),i(y)){case"object":e.mixObject(y,f(t))}}}catch(t){g.e(t)}finally{g.f()}return l(t,d)}return s}()}},{key:"to",value:function(t){for(var e={},r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];n.map(function(r){switch(i(r)){case"object":Object.assign(e,Object.getOwnPropertyDescriptors(r));break;case"function":Object.assign(e,Object.getOwnPropertyDescriptors(r.prototype))}delete e.constructor,Object.defineProperties(t.prototype,e)})}},{key:"with",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.from.apply(this,[Object].concat(e))}},{key:"mixObject",value:function(t,e){var r,n=o(Object.getOwnPropertyNames(t));try{for(n.s();!(r=n.n()).done;){var i=r.value;"function"!=typeof t[i]?e[i]=t[i]:e[i]=t[i].bind(e)}}catch(t){n.e(t)}finally{n.f()}var a,s=o(Object.getOwnPropertySymbols(t));try{for(s.s();!(a=s.n()).done;){var c=a.value;"function"!=typeof t[c]?e[c]=t[c]:e[c]=t[c].bind(e)}}catch(t){s.e(t)}finally{s.f()}}},{key:"mixClass",value:function(t,e){var r,n=o(Object.getOwnPropertyNames(t.prototype));try{for(n.s();!(r=n.n()).done;){var i=r.value;e.prototype[i]=t.prototype[i].bind(e.prototype)}}catch(t){n.e(t)}finally{n.f()}var a,s=o(Object.getOwnPropertySymbols(t.prototype));try{for(s.s();!(a=s.n()).done;){var c=a.value;e.prototype[c]=t.prototype[c].bind(e.prototype)}}catch(t){s.e(t)}finally{s.f()}var u,l=o(Object.getOwnPropertyNames(t));try{var f=function(){var r=u.value;if("function"!=typeof t[r])return"continue";var n=e[r]||!1,i=t[r].bind(e);e[r]=function(){return n&&n.apply(void 0,arguments),i.apply(void 0,arguments)}};for(l.s();!(u=l.n()).done;)f()}catch(t){l.e(t)}finally{l.f()}var h,p=o(Object.getOwnPropertySymbols(t));try{var d=function(){var r=h.value;if("function"!=typeof t[r])return"continue";var n=e[r]||!1,i=t[r].bind(e);e[r]=function(){return n&&n.apply(void 0,arguments),i.apply(void 0,arguments)}};for(p.s();!(h=p.n()).done;)d()}catch(t){p.e(t)}finally{p.f()}}},{key:"mix",value:function(e){for(var r={},i={},a=t.Bindable.makeBindable(e),s=function(t){var e,s=Object.getOwnPropertyNames(t.prototype),c=/^(before|after)__(.+)/,u=o(Object.getOwnPropertyNames(t));try{var l=function(){var i=e.value,o=i.match(c);if(o){switch(o[1]){case"before":a.___before(function(e,r,a,s,c){if(r===o[2])return t[i].bind(s).apply(void 0,n(c))});break;case"after":a.___after(function(e,r,a,s,c){if(r===o[2])return t[i].bind(s).apply(void 0,n(c))})}return"continue"}return r[i]?"continue":"function"!=typeof t[i]?"continue":void(r[i]=t[i])};for(u.s();!(e=u.n()).done;)l()}catch(t){u.e(t)}finally{u.f()}var f,h=o(s);try{var p=function(){var e=f.value,r=e.match(c);if(r){switch(r[1]){case"before":a.___before(function(i,o,a,s,c){if(o===r[2])return t.prototype[e].bind(s).apply(void 0,n(c))});break;case"after":a.___after(function(i,o,a,s,c){if(o===r[2])return t.prototype[e].bind(s).apply(void 0,n(c))})}return"continue"}return i[e]?"continue":"function"!=typeof t.prototype[e]?"continue":void(i[e]=t.prototype[e])};for(h.s();!(f=h.n()).done;)p()}catch(t){h.e(t)}finally{h.f()}},c=this;c&&c.prototype;c=Object.getPrototypeOf(c))s(c);for(var u in r)e[u]=r[u].bind(e);var l=function(t){e.prototype[t]=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return i[t].apply(this,r)}};for(var f in i)l(f);return a}}],(a=null)&&d(r.prototype,a),s&&d(r,s),e}());e.Mixin=y,y.Constructor=g}()}),require.register("curvature/base/Router.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Router=void 0;var t=r("./View"),n=(r("./Cache"),r("./Config")),i=r("./Routes");function o(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=Symbol("NotFound"),u=Symbol("Internal"),l=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,a,u;return r=e,u=[{key:"wait",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOMContentLoaded";(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).addEventListener(r,function(){e.listen(t)})}},{key:"listen",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.routes=r,Object.assign(this.query,this.queryOver({}));var n=function(r){for(var n in r.preventDefault(),r.state&&"routedId"in r.state?r.state.routedId<=e.routeCount?(e.history.splice(r.state.routedId),e.routeCount=r.state.routedId):r.state.routedId>e.routeCount&&(e.history.push(r.state.prev),e.routeCount=r.state.routedId):null!==e.prevPath&&e.prevPath!==location.pathname&&e.history.push(e.prevPath),"null"!==location.origin?e.match(location.pathname,t):e.match(e.nextPath,t),e.query)delete e.query[n];Object.assign(e.query,e.queryOver({}))};window.addEventListener("popstate",n),window.addEventListener("cvUrlChanged",n);var i="null"!==location.origin&&location.pathname+location.search;location.origin&&location.hash&&(i+=location.hash),this.go(!1!==i?i:"/")}},{key:"go",value:function(t,e){var r=n.Config.get("title");for(var i in r&&(document.title=r),"null"===location.origin?this.nextPath=t:2===e&&location.pathname!==t?history.replaceState({routedId:this.routeCount,prev:this.prevPath,url:location.pathname},null,t):location.pathname!==t&&history.pushState({routedId:++this.routeCount,prev:this.prevPath,url:location.pathname},null,t),e||(!1===e&&(this.path=null),"#"===t.substring(0,1)?window.dispatchEvent(new HashChangeEvent("hashchange")):window.dispatchEvent(new CustomEvent("cvUrlChanged"))),this.query)delete this.query[i];Object.assign(this.query,this.queryOver({})),this.prevPath=t}},{key:"match",value:function(e,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.path!==e||o){this.queryString=location.search,this.path=e;var a=this.prevPath,s=r.args.content,u=this.routes||r.routes||i.Routes.dump();new URLSearchParams(location.search);for(var l in this.query)delete this.query[l];Object.assign(this.query,this.queryOver({}));var f={},h=!1,p="";for(var d in e=e.substr(1).split("/"),this.query)f[d]=this.query[d];t:for(var g in u){var y=g.split("/");if(!(y.length<e.length&&"*"!==y[y.length-1])){for(var v in y)if("%"==y[v].substr(0,1)){var b=null,m=/^%(\w+)\??/.exec(y[v]);if(m&&m[1]&&(b=m[1]),!b)throw new Error("".concat(y[v],' is not a valid argument segment in route "').concat(g,'"'));if(e[v])f[b]=e[v];else{if("?"!=y[v].substr(y[v].length-1,1))continue t;f[b]=""}}else if("*"!==y[v]&&e[v]!==y[v])continue t;h=g,p=u[g],"*"===y[y.length-1]&&(f.pathparts=e.slice(y.length-1));break}}var w=new CustomEvent("cvRouteStart",{cancelable:!0,detail:{path:e,prev:a,root:r,selected:h,routes:u}});if(document.dispatchEvent(w)){if(!o&&r&&s&&p instanceof Object&&s instanceof p&&!(p instanceof Promise)&&s.update(f))return r.args.content=s,!0;try{h in u||(u[h]=u[c]);var S=function(e){return"function"==typeof u[e]?u[e].prototype instanceof t.View?new u[e](f):u[e](f):u[e]};return!1===(p=S(h))&&(p=S(c)),p instanceof Promise?p.then(function(t){n.update(r,e,t,u,h,f,o)}).catch(function(t){throw document.dispatchEvent(new CustomEvent("cvRouteError",{detail:{error:t,path:e,prev:a,view:r,routes:u,selected:h}})),n.update(r,e,window.devMode?String(t):"Error: 500",u,h,f,o),t}):this.update(r,e,p,u,h,f,o)}catch(t){throw document.dispatchEvent(new CustomEvent("cvRouteError",{detail:{error:t,path:e,prev:a,view:r,routes:u,selected:h}})),this.update(r,e,window.devMode?String(t):"Error: 500",u,h,f,o),t}}}}},{key:"update",value:function(e,r,n,i,o,a,s){if(e){var c=this.prevPath,u=new CustomEvent("cvRoute",{cancelable:!0,detail:{result:n,path:r,prev:c,view:e,routes:i,selected:o}});!1!==n&&(e.args.content instanceof t.View&&(e.args.content.pause(!0),e.args.content.remove()),document.dispatchEvent(u)&&(e.args.content=n),n instanceof t.View&&(n.pause(!1),n.update(a,s)));var l=new CustomEvent("cvRouteEnd",{cancelable:!0,detail:{result:n,path:r,prev:c,view:e,routes:i,selected:o}});document.dispatchEvent(l)}}},{key:"queryOver",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={},n={},i=o(new URLSearchParams(location.search));try{for(i.s();!(t=i.n()).done;){var a=t.value;n[a[0]]=a[1]}}catch(t){i.e(t)}finally{i.f()}return delete(r=Object.assign(r,n,e)).api,r}},{key:"queryToString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=t;for(var i in e||(n=this.queryOver(t)),n)""!==n[i]&&r.push(i+"="+encodeURIComponent(n[i]));return r.join("&")}},{key:"setQuery",value:function(t,e,r){var n=this.queryOver();n[t]=e,void 0===e&&delete n[t];var i=this.queryToString(n,!0);this.go(location.pathname+(i?"?"+i:""),r)}}],(a=null)&&s(r.prototype,a),u&&s(r,u),e}();e.Router=l,Object.defineProperty(l,"query",{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(l,"history",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(l,"routeCount",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(l,"prevPath",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(l,"queryString",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(l,"InternalError",{configurable:!1,enumerable:!1,writable:!1,value:u}),Object.defineProperty(l,"NotFoundError",{configurable:!1,enumerable:!1,writable:!1,value:c})}()}),require.register("curvature/base/Routes.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Routes=void 0;var n={};try{Object.assign(n,r("Routes").Routes||{})}catch(t){!0===window.devMode&&console.warn(t)}var i=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"get",value:function(t){return this.routes[t]}},{key:"dump",value:function(){return this.routes}}],(n=null)&&t(r.prototype,n),i&&t(r,i),e}();e.Routes=i,Object.defineProperty(i,"routes",{configurable:!1,enumerable:!1,writable:!1,value:n})}()}),require.register("curvature/base/RuleSet.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RuleSet=void 0;r("./Dom");var t=r("./Tag"),n=r("./View");function i(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,o,s;return r=e,s=[{key:"add",value:function(t,e){return this.globalRules=this.globalRules||{},this.globalRules[t]=this.globalRules[t]||[],this.globalRules[t].push(e),this}},{key:"apply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r in this.globalRules)for(var n in this.globalRules[r]){var o,a=this.globalRules[r][n],s=this.wrap(t,a,e),c=i(t.querySelectorAll(r));try{for(c.s();!(o=c.n()).done;){s(o.value)}}catch(t){c.e(t)}finally{c.f()}}}},{key:"wait",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DOMContentLoaded",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=function(e,r){return function(){return r.removeEventListener(e,n),t.apply()}}(e,r);r.addEventListener(e,n)}},{key:"wrap",value:function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(r instanceof n.View||r&&r.prototype&&r.prototype instanceof n.View)&&(r=function(t){return function(){return t}}(r)),function(e){for(var o in void 0===e.___cvApplied___&&Object.defineProperty(e,"___cvApplied___",{enumerable:!1,writable:!1,value:[]}),e.___cvApplied___)if(r==e.___cvApplied___[o])return;var a,s;i&&(a=s=i,i.viewList&&(s=i.viewList.parent)),s&&s.onRemove(function(){return e.___cvApplied___.splice(0)});var c,u=new t.Tag(e,s,null,void 0,a),l=u.element.parentNode,f=u.element.nextSibling,h=r(u);if(!1!==h&&e.___cvApplied___.push(r),h instanceof HTMLElement&&(h=new t.Tag(h)),h instanceof t.Tag){if(!h.element.contains(u.element)){for(;u.element.firstChild;)h.element.appendChild(u.element.firstChild);u.remove()}f?l.insertBefore(h.element,f):l.appendChild(h.element)}h&&h.prototype&&h.prototype instanceof n.View&&(h=new h({},i)),h instanceof n.View&&(i&&(i.cleanup.push((c=h,function(){c.remove()})),i.cleanup.push(i.args.bindTo(function(t,e,r){r[e]=t,h.args[e]=t})),i.cleanup.push(h.args.bindTo(function(t,e,r,n){r[e]=t,i.args[e]=t}))),u.clear(),h.render(u.element))}}}],(o=[{key:"add",value:function(t,e){return this.rules=this.rules||{},this.rules[t]=this.rules[t]||[],this.rules[t].push(e),this}},{key:"apply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var n in e.apply(t,r),this.rules)for(var o in this.rules[n]){var a,s=this.rules[n][o],c=e.wrap(t,s,r),u=i(t.querySelectorAll(n));try{for(u.s();!(a=u.n()).done;){c(a.value)}}catch(t){u.e(t)}finally{u.f()}}}}])&&a(r.prototype,o),s&&a(r,s),e}();e.RuleSet=s}()}),require.register("curvature/base/Tag.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=void 0;var t=r("./Bindable");function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(){function e(r,n,i,o,a){var s,c=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof r){var u=document.createRange().createContextualFragment(r);r=u.firstChild}return this.element=t.Bindable.makeBindable(r),this.node=this.element,this.parent=n,this.direct=a,this.ref=i,this.index=o,this.cleanup=[],this[t.Bindable.OnAllGet]=function(t){return"function"==typeof c[t]?c[t]:c.node&&"function"==typeof c.node[t]?function(){var e;return(e=c.node)[t].apply(e,arguments)}:c.node&&t in c.node?c.node[t]:c[t]},this.style=(s=this,t.Bindable.make(function(t){if(s.node){var e=new CustomEvent("cvStyle",{detail:{styles:t}});if(s.node.dispatchEvent(e))for(var r in t)s.node.style.setProperty(r,t[r])}})),this.proxy=t.Bindable.make(this),this.proxy.style.bindTo(function(t,e){c.element.style[e]=t}),this.proxy.bindTo(function(t,e){return e in r&&(r[e]=t),!1}),this.proxy}var r,i,o;return r=e,(i=[{key:"attr",value:function(t){for(var e in t)void 0===t[e]?this.node.removeAttribute(e):null===t[e]?this.node.setAttribute(e,""):this.node.setAttribute(e,t[e])}},{key:"remove",value:function(){var e;for(this.node&&this.node.remove(),t.Bindable.clearBindings(this);e=this.cleanup.shift();)e();if(this.clear(),this.node){var r=new Event("cvDomDetached");this.node.dispatchEvent(r),this.node=this.element=this.ref=this.parent=void 0}}},{key:"clear",value:function(){if(this.node)for(var t=new Event("cvDomDetached");this.node.firstChild;)this.node.firstChild.dispatchEvent(t),this.node.removeChild(this.node.firstChild)}},{key:"pause",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}},{key:"listen",value:function(t,e,r){var n=this.node;n.addEventListener(t,e,r);var i=function(){n.removeEventListener(t,e,r)},o=function(){i(),i=function(){return console.warn("Already removed!")}};return this.parent.onRemove(function(){return o()}),o}}])&&n(r.prototype,i),o&&n(r,o),e}();e.Tag=i}()}),require.register("curvature/base/View.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var t=r("./Bindable"),n=r("./ViewList"),i=r("./Router"),o=r("./Dom"),a=r("./Tag"),s=r("./Bag"),c=r("./RuleSet"),u=r("./Mixin"),l=(r("../mixin/PromiseMixin"),r("../mixin/EventTargetMixin"));function f(t){"@babel/helpers - typeof";return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function g(t,e){if(t){if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function b(t,e,r){return e&&v(t.prototype,e),r&&v(t,r),t}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=k(t);if(e){var i=k(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return S(this,r)}}function S(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?O(t):e}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var A=Symbol("dontParse"),x=Symbol("expandBind"),_=Symbol("uuid"),P=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(g,u.Mixin["with"](l.EventTargetMixin));var f=w(g);function g(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),e=f.call(this,r,n),Object.defineProperty(O(e),"args",{value:t.Bindable.make(r)}),Object.defineProperty(O(e),_,{value:e.uuid()}),Object.defineProperty(O(e),"attach",{value:new s.Bag(function(t,e,r){})}),Object.defineProperty(O(e),"detach",{value:new s.Bag(function(t,e,r){})}),Object.defineProperty(O(e),"_onRemove",{value:new s.Bag(function(t,e,r){})}),Object.defineProperty(O(e),"cleanup",{value:[]}),Object.defineProperty(O(e),"parent",{value:n}),Object.defineProperty(O(e),"views",{value:new Map}),Object.defineProperty(O(e),"viewLists",{value:new Map}),Object.defineProperty(O(e),"withViews",{value:new Map}),Object.defineProperty(O(e),"tags",{value:t.Bindable.make({})}),Object.defineProperty(O(e),"nodes",{value:t.Bindable.make([])}),Object.defineProperty(O(e),"intervals",{value:[]}),Object.defineProperty(O(e),"timeouts",{value:[]}),Object.defineProperty(O(e),"frames",{value:[]}),Object.defineProperty(O(e),"ruleSet",{value:new c.RuleSet}),Object.defineProperty(O(e),"preRuleSet",{value:new c.RuleSet}),Object.defineProperty(O(e),"subBindings",{value:{}}),Object.defineProperty(O(e),"templates",{value:{}}),Object.defineProperty(O(e),"eventCleanup",{value:[]}),Object.defineProperty(O(e),"interpolateRegex",{value:/(\[\[((?:\$+)?[\w\.\|-]+)\]\])/g}),Object.defineProperty(O(e),"rendered",{value:new Promise(function(t,r){return Object.defineProperty(O(e),"renderComplete",{value:t})})}),e.template="",e.firstNode=null,e.lastNode=null,e.viewList=null,e.mainView=null,e.preserve=!1,e.removed=!1,S(e,t.Bindable.make(O(e)))}return b(g,[{key:"_id",get:function(){return this[_]}}],[{key:"from",value:function(t){var e=new this(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);return e.template=t,e}}]),b(g,[{key:"onFrame",value:function(t){var e=this,r=!1,n=function(){r=!0};return requestAnimationFrame(function(){return function n(i){e.removed||r||(e.paused||t(Date.now()),requestAnimationFrame(n))}(Date.now())}),this.frames.push(n),n}},{key:"onNextFrame",value:function(t){return requestAnimationFrame(function(){return t(Date.now())})}},{key:"onIdle",value:function(t){return requestIdleCallback(function(){return t(Date.now())})}},{key:"onTimeout",value:function(t,e){var r=this,n=function(){r.timeouts[o].fired=!0,r.timeouts[o].callback=null,e()},i=setTimeout(n,t),o=this.timeouts.length;return this.timeouts.push({timeout:i,callback:n,time:t,fired:!1,created:(new Date).getTime(),paused:!1}),i}},{key:"clearTimeout",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){for(var e in this.timeouts)t===this.timeouts[e].timeout&&(clearTimeout(this.timeouts[e].timeout),delete this.timeouts[e])})},{key:"onInterval",value:function(t,e){var r=setInterval(e,t);return this.intervals.push({timeout:r,callback:e,time:t,paused:!1}),r}},{key:"clearInterval",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){for(var e in this.intervals)t===this.intervals[e].timeout&&(clearInterval(this.intervals[e].timeout),delete this.intervals[e])})},{key:"pause",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0===t&&(this.paused=!this.paused),this.paused=t,this.paused){for(var e in this.timeouts)this.timeouts[e].fired?delete this.timeouts[e]:clearTimeout(this.timeouts[e].timeout);for(var r in this.intervals)clearInterval(this.intervals[r].timeout)}else{for(var n in this.timeouts)this.timeouts[n].timeout.paused&&(this.timeouts[n].fired?delete this.timeouts[n]:this.timeouts[n].timeout=setTimeout(this.timeouts[n].callback,this.timeouts[n].time));for(var i in this.intervals)this.intervals[i].timeout.paused&&(this.intervals[i].timeout.paused=!1,this.intervals[i].timeout=setInterval(this.intervals[i].callback,this.intervals[i].time))}var o,a=d(this.viewLists);try{for(a.s();!(o=a.n()).done;){var s=p(o.value,2);s[0];s[1].pause(!!t)}}catch(t){a.e(t)}finally{a.f()}for(var c in this.tags)if(Array.isArray(this.tags[c]))for(var u in this.tags[c])this.tags[c][u].pause(!!t);else this.tags[c].pause(!!t)}},{key:"render",value:function(){var t,e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r instanceof g&&(r=r.firstNode.parentNode),n instanceof g&&(n=n.firstNode),this.firstNode)return this.reRender(r,n);this.dispatchEvent(new CustomEvent("render"));var i=this.template instanceof DocumentFragment?this.template.cloneNode(!0):g.templates.has(this.template),o=i?this.template instanceof DocumentFragment?i:g.templates.get(this.template).cloneNode(!0):document.createRange().createContextualFragment(this.template);if(i||this.template instanceof DocumentFragment||g.templates.set(this.template,o.cloneNode(!0)),this.mainView||this.preRuleSet.apply(o,this),this.mapTags(o),this.mainView||this.ruleSet.apply(o,this),!0===window.devMode?(this.firstNode=document.createComment("Template ".concat(this._id," Start")),this.lastNode=document.createComment("Template ".concat(this._id," End"))):(this.firstNode=document.createTextNode(""),this.lastNode=document.createTextNode("")),(t=this.nodes).push.apply(t,[this.firstNode].concat(h(Array.from(o.childNodes)),[this.lastNode])),this.postRender(r),this.dispatchEvent(new CustomEvent("rendered")),this.dispatchAttach()){if(r){var a=r.getRootNode(),s=!1;a.isConnected&&(s=!0,"external"),n?(r.insertBefore(this.firstNode,n),r.insertBefore(this.lastNode,n)):(r.appendChild(this.firstNode),r.appendChild(this.lastNode)),r.insertBefore(o,this.lastNode),0,s?(this.attached(a,r),this.dispatchAttached(a,r)):r.addEventListener("cvDomAttached",function(){e.attached(a,r),e.dispatchAttached(a,r)},{once:!0})}return this.renderComplete(this.nodes),this.nodes}}},{key:"dispatchAttach",value:function(){return this.dispatchEvent(new CustomEvent("attach",{cancelable:!0,target:this}))}},{key:"dispatchAttached",value:function(t,e){this.dispatchEvent(new CustomEvent("attached",{target:this}));var r=this.attach.items();for(var n in r)r[n](t,e);this.nodes.filter(function(t){return t.nodeType!==Node.COMMENT_NODE}).map(function(t){t.matches&&(o.Dom.mapTags(t,!1,function(t,e){t.matches&&t.dispatchEvent(new Event("cvDomAttached",{target:t}))}),t.dispatchEvent(new Event("cvDomAttached",{target:t})))})}},{key:"reRender",value:function(t,e){if(this.dispatchEvent(new CustomEvent("reRender"),{cancelable:!0,target:this})){var r=new DocumentFragment;if(this.firstNode.isConnected){var n=this.detach.items();for(var i in n)n[i]()}if(r.append.apply(r,h(this.nodes)),t){e?(t.insertBefore(this.firstNode,e),t.insertBefore(this.lastNode,e)):(t.appendChild(this.firstNode),t.appendChild(this.lastNode)),t.insertBefore(r,this.lastNode),this.dispatchEvent(new CustomEvent("reRendered"),{cancelable:!0,target:this});var o=t.getRootNode();o.isConnected&&(this.attached(o,t),this.dispatchAttached(o,t))}return this.nodes}}},{key:"mapTags",value:function(t){var e=this;o.Dom.mapTags(t,!1,function(t,r){t[A]||(t=t.matches?(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=e.mapInterpolatableTag(t)).matches("[cv-template]")&&e.mapTemplateTag(t)||t).matches("[cv-slot]")&&e.mapSlotTag(t)||t).matches("[cv-prerender]")&&e.mapPrendererTag(t)||t).matches("[cv-link]")&&e.mapLinkTag(t)||t).matches("[cv-attr]")&&e.mapAttrTag(t)||t).matches("[cv-expand]")&&e.mapExpandableTag(t)||t).matches("[cv-ref]")&&e.mapRefTag(t)||t).matches("[cv-on]")&&e.mapOnTag(t)||t).matches("[cv-each]")&&e.mapEachTag(t)||t).matches("[cv-bind]")&&e.mapBindTag(t)||t).matches("[cv-with]")&&e.mapWithTag(t)||t).matches("[cv-if]")&&e.mapIfTag(t)||t).matches("[cv-view]")&&e.mapViewTag(t)||t:e.mapInterpolatableTag(t))!==r.currentNode&&(r.currentNode=t)})}},{key:"mapExpandableTag",value:function(e){var r=e[x];r&&(r(),e[x]=!1);var n=p(t.Bindable.resolve(this.args,e.getAttribute("cv-expand"),!0),2),i=n[0],o=n[1];return e.removeAttribute("cv-expand"),i[o]||(i[o]={}),this.onRemove(e[x]=i[o].bindTo(function(t,r,n,i,o){i||void 0===t?e.removeAttribute(r,t):null!==t?e.setAttribute(r,t):e.setAttribute(r,"")})),e}},{key:"compileExpandableTag",value:function(e){return function(r){var n=e.cloneNode(!0),i=n.getAttribute("cv-expand"),o=t.Bindable.make(r.args[i]||{});n.removeAttribute("cv-expand");var a=function(e){if("name"===e||"type"===e)return"continue";var i=o.bindTo(e,function(t,e){return function(r){t.setAttribute(e,r)}}(n,e));r.onRemove(function(){i(),o.isBound()&&t.Bindable.clearBindings(o)})};for(var s in o)a(s);return n}}},{key:"mapAttrTag",value:function(t){var e=this.compileAttrTag(t)(this);return t.replaceWith(e),e}},{key:"compileAttrTag",value:function(e){var r=e.getAttribute("cv-attr").split(",").map(function(t){return t.split(":")});return e.removeAttribute("cv-attr"),function(n){var i=e.cloneNode(!0),o=function(e){var o=r[e][1]||r[e][0],a=p(t.Bindable.resolve(n.args,o,!0),2),s=a[0],c=a[1],u=r[e][0];n.onRemove(s.bindTo(c,function(t,e,r,n){n||void 0===t?i.removeAttribute(u,t):null!==t?i.setAttribute(u,t):i.setAttribute(u,"")}))};for(var a in r)o(a);return i}}},{key:"mapInterpolatableTag",value:function(e){var r=this,n=this.interpolateRegex;if(e.nodeType===Node.TEXT_NODE){var i=e.nodeValue;if(!this.interpolatable(i))return e;for(var o,s=0,c=function(){var n=o[2],c=!1,u=!1,l=n.split("|"),f=!1;if(l.length>1&&(f=r.stringTransformer(l.slice(1)),n=l[0]),"$$"===n.substr(0,2)&&(c=!0,u=!0,n=n.substr(2)),"$"===n.substr(0,1)&&(c=!0,n=n.substr(1)),"000"===n.substr(0,3))return expand=!0,n=n.substr(3),"continue";var h=i.substring(s,o.index);s=o.index+o[1].length;var d=document.createTextNode(h);d[A]=!0,e.parentNode.insertBefore(d,e);var y=void 0;(y=c?document.createElement("div"):document.createTextNode(""))[A]=!0;var v=r.args,b=n;if(n.match(/\./)){var m=p(t.Bindable.resolve(r.args,n,!0),2);v=m[0],b=m[1]}e.parentNode.insertBefore(y,e);var w=v.bindTo(b,function(t,n,i){if(i[n]!==t&&(i[n]instanceof g||i[n]instanceof Node||i[n]instanceof a.Tag)&&(i[n].preserve||i[n].remove()),y.nodeValue="",u&&!(t instanceof g)){var o=t;(t=new g(r.args,r)).template=o}if(f&&(t=f(t)),t instanceof g){var s=function(e){t.dispatchAttach()&&(t.attached(e),t.dispatchAttached())};r.attach.add(s),t.render(e.parentNode,y);var l=function(){t.preserve||t.remove()};r.onRemove(l),t.onRemove(function(){r.attach.remove(s),r._onRemove.remove(l)})}else t instanceof Node?(e.parentNode.insertBefore(t,y),r.onRemove(function(){return t.remove()})):t instanceof a.Tag?(e.parentNode.insertBefore(t.node,y),r.onRemove(function(){return t.remove()})):(t instanceof Object&&t.__toString instanceof Function&&(t=t.__toString()),c?y.innerHTML=t:y.nodeValue=t);y[A]=!0});r.onRemove(w)};o=n.exec(i);)c();var u=i.substring(s),l=document.createTextNode(u);l[A]=!0,e.parentNode.insertBefore(l,e),e.nodeValue=""}if(e.nodeType===Node.ELEMENT_NODE)for(var f=function(i){if(!r.interpolatable(e.attributes[i].value))return"continue";for(var o=0,a=void 0,s=e.attributes[i].value,c=e.attributes[i],u={},l=[];a=n.exec(s);)l.push(s.substring(o,a.index)),u[a[2]]||(u[a[2]]=[]),u[a[2]].push(l.length),l.push(a[1]),o=a.index+a[1].length;l.push(s.substring(o));var f=function(n){var i=r.args,o=n,a=n.split("|"),s=!1,f=n;if(a.length>1&&(s=r.stringTransformer(a.slice(1)),o=a[0]),o.match(/\./)){var h=p(t.Bindable.resolve(r.args,o,!0),2);i=h[0],o=h[1]}u[f];r.onRemove(i.bindTo(o,function(t,r,n,i){for(var a in s&&(t=s(t)),u)for(var h in u[f])l[u[f][h]]=n[a],r===o&&(l[u[f][h]]=t);e.setAttribute(c.name,l.join(""))})),r.onRemove(function(){i.isBound()||t.Bindable.clearBindings(i)})};for(var h in u)f(h)},h=0;h<e.attributes.length;h++)f(h);return e}},{key:"mapRefTag",value:function(t){var e=p(t.getAttribute("cv-ref").split(":"),3),r=e[0],n=e[1],i=void 0===n?null:n,o=e[2],s=void 0===o?null:o,c=a.Tag;i&&(c=this.stringToClass(i)),t.removeAttribute("cv-ref"),Object.defineProperty(t,"___tag___",{enumerable:!1,writable:!0}),this.onRemove(function(){t.___tag___=null,t.remove()});var u=this;this.viewList&&(u=this.viewList.parent);var l=new c(t,this,r,void 0,this);for(t.___tag___=l,this.tags[r]=l;u;){u.parent;var f=this.args[s];void 0!==f?(u.tags[r]||(u.tags[r]=[]),u.tags[r][f]=l):u.tags[r]=l,u=u.parent}return t}},{key:"mapBindTag",value:function(e){var r=this,n=e.getAttribute("cv-bind"),i=this.args,s=n,c=null;if(n.match(/\./)){var u=p(t.Bindable.resolve(this.args,n,!0),3);i=u[0],s=u[1],c=u[2]}i!==this.args&&(this.subBindings[n]=this.subBindings[n]||[],this.onRemove(this.args.bindTo(c,function(){for(;r.subBindings.length;)r.subBindings.shift()()})));var l=!1;"$"===s.substr(0,1)&&(s=s.substr(1),l=!0);var f=i.bindTo(s,function(t,n,i,s,c){(c instanceof g||c instanceof Node||c instanceof a.Tag)&&c!==t&&c.remove();var u=new CustomEvent("cvAutoChanged",{bubbles:!0});if(["INPUT","SELECT","TEXTAREA"].includes(e.tagName)){var f=e.getAttribute("type");if(f&&"checkbox"===f.toLowerCase())e.checked=!!t,e.dispatchEvent(u);else if(f&&"radio"===f.toLowerCase())e.checked=t==e.value,e.dispatchEvent(u);else if("file"!==f){if("SELECT"===e.tagName){var h=function(){for(var r=0;r<e.options.length;r++){e.options[r].value==t&&(e.selectedIndex=r)}};h(),r.attach.add(h)}else e.value=null==t?"":t;e.dispatchEvent(u)}}else if(t instanceof g){var p,y=d(e.childNodes);try{for(y.s();!(p=y.n()).done;){p.value.remove()}}catch(t){y.e(t)}finally{y.f()}var v=function(e){t.dispatchAttach()&&(t.attached(e),t.dispatchAttached())};r.attach.add(v),t.render(e),t.onRemove(function(){return r.attach.remove(v)})}else if(t instanceof Node)e.insert(t);else if(t instanceof a.Tag)e.append(t.node);else if(l){if(e.innerHTML!==t){if(t=String(t),e.innerHTML===t.substring(0,e.innerHTML.length))e.innerHTML+=t.substring(e.innerHTML.length);else{var b,m=d(e.childNodes);try{for(m.s();!(b=m.n()).done;){b.value.remove()}}catch(t){m.e(t)}finally{m.f()}e.innerHTML=t}o.Dom.mapTags(e,!1,function(t){return t[A]=!0})}}else if(e.textContent!==t){var w,S=d(e.childNodes);try{for(S.s();!(w=S.n()).done;){w.value.remove()}}catch(t){S.e(t)}finally{S.f()}e.textContent=t}});i!==this.args&&this.subBindings[n].push(f),this.onRemove(f);var h=e.getAttribute("type"),y=e.getAttribute("multiple"),v=function(r){if(r.target===e)if(h&&"checkbox"===h.toLowerCase())e.checked?i[s]=r.target.getAttribute("value"):i[s]=!1;else if(r.target.matches("[contenteditable=true]"))i[s]=r.target.innerHTML;else if("file"===h&&y){var n=Array.from(r.target.files),o=i[s]||t.Bindable.onDeck(i,s);if(o&&n.length){var a=function(t){if(n[t]!==o[t])return n[t].toJSON=function(){return{name:file[t].name,size:file[t].size,type:file[t].type,date:file[t].lastModified}},o[t]=n[t],"break"};for(var c in n){if("break"===a(c))break}}else i[s]=n}else if("file"!==h||y)i[s]=r.target.value;else{var u=r.target.files.item(0);u.toJSON=function(){return{name:u.name,size:u.size,type:u.type,date:u.lastModified}},i[s]=u}};return"file"===h||"radio"===h?e.addEventListener("change",v):(e.addEventListener("input",v),e.addEventListener("change",v),e.addEventListener("value-changed",v)),this.onRemove(function(){"file"===h||"radio"===h?e.removeEventListener("change",v):(e.removeEventListener("input",v),e.removeEventListener("change",v),e.removeEventListener("value-changed",v))}),e.removeAttribute("cv-bind"),e}},{key:"mapOnTag",value:function(t){var e=this;return String(t.getAttribute("cv-on")).split(";").map(function(t){return t.split(":")}).map(function(r){var n,i=(r=r.map(function(t){return t.trim()})).length,o=String(r.shift()).trim(),a=String(r.shift()||o).trim(),s=String(r.shift()||"").trim(),c=[],u=/(\w+)(?:\(([$\w\s-'",]+)\))?/.exec(a);u?(a=u[1].replace(/(^[\s\n]+|[\s\n]+$)/,""),u[2]&&(c=u[2].split(",").map(function(t){return t.trim()})),u.length):c.push("$event"),o&&1!==i||(o=a);for(var l=e;l;){if("function"==typeof l[a])if("break"===function(){var t=l,e=a;return n=function(){t[e].apply(t,arguments)},"break"}())break;if(!l.parent)break;l=l.parent}var f=function(r){var i=c.map(function(n){var i;return parseInt(n)==n?n:"event"===n||"$event"===n?r:"$view"===n?l:"$tag"===n?t:"$parent"===n?e.parent:"$subview"===n?e:n in e.args?e.args[n]:(i=/^['"]([\w-]+?)["']$/.exec(n))?i[1]:void 0});if("function"!=typeof n)throw new Error("".concat(a," is not defined on View object.")+"\nTag:\n"+"".concat(t.outerHTML));n.apply(void 0,h(i))},p={};switch(s.includes("p")?p.passive=!0:s.includes("P")&&(p.passive=!1),s.includes("c")?p.capture=!0:s.includes("C")&&(p.capture=!1),s.includes("o")?p.once=!0:s.includes("O")&&(p.once=!1),o){case"_init":f();break;case"_attach":e.attach.add(f);break;case"_detach":e.detach.add(f);break;default:t.addEventListener(o,f,p),e.onRemove(function(){t.removeEventListener(o,f,p)})}return[o,a,c]}),t.removeAttribute("cv-on"),t}},{key:"mapLinkTag",value:function(t){var e=t.getAttribute("cv-link");t.setAttribute("href",e);var r=function(r){r.preventDefault(),"http"!==e.substring(0,4)&&"//"!==e.substring(0,2)?i.Router.go(t.getAttribute("href")):window.open(t.getAttribute("href",e))};return t.addEventListener("click",r),this.onRemove(function(t,e){return function(){t.removeEventListener("click",e),t=void 0,e=void 0}}(t,r)),t.removeAttribute("cv-link"),t}},{key:"compileLinkTag",value:function(t){var e=t.getAttribute("cv-link");return t.removeAttribute("cv-link"),function(r){var n=t.cloneNode(!0);return n.setAttribute("href",e),n}}},{key:"mapPrendererTag",value:function(t){var e=t.getAttribute("cv-prerender"),r=window.prerenderer||navigator.userAgent.match(/prerender/i);return r&&(window.prerenderer=window.prerenderer||!0),("never"===e&&r||"only"===e&&!r)&&t.parentNode.removeChild(t),t}},{key:"mapWithTag",value:function(e){var r=this,n=e.getAttribute("cv-with"),i=e.getAttribute("cv-carry"),o=e.getAttribute("cv-view");e.removeAttribute("cv-with"),e.removeAttribute("cv-carry"),e.removeAttribute("cv-view");var a=o?this.stringToClass(o):g,s=new DocumentFragment;h(e.childNodes).map(function(t){return s.appendChild(t)});var c=[];i&&(c=i.split(",").map(function(t){return t.trim()}));var u=this.args.bindTo(n,function(n,i,o,u){for(r.withViews.has(e)&&r.withViews.delete(e);e.firstChild;)e.removeChild(e.firstChild);var l=new a({},r);r.onRemove(function(t){return function(){t.remove()}}(l)),l.template=s;var f=function(t){var e=r.args.bindTo(c[t],function(t,e){l.args[e]=t});l.onRemove(e),r.onRemove(function(){e(),l.remove()})};for(var h in c)f(h);var p=function(e){var i=n.bindTo(e,function(t,e){l.args[e]=t});l.args.bindTo(e,function(t,e){n[e]=t});r.onRemove(function(){i(),n.isBound()||t.Bindable.clearBindings(n),l.remove()}),l.onRemove(function(){i(),n.isBound()||t.Bindable.clearBindings(n)})};for(var d in n)p(d);l.render(e),r.withViews.set(e,l)});return this.onRemove(function(){r.withViews.delete(e),u()}),e}},{key:"mapViewTag",value:function(t){var e=this,r=t.getAttribute("cv-view");t.removeAttribute("cv-view");var n=new DocumentFragment;h(t.childNodes).map(function(t){return n.appendChild(t)});var i=r.split(":"),o=i.pop()?this.stringToClass(r):g,a=i.shift(),s=new o(this.args,this);return this.views.set(t,s),a&&this.views.set(a,s),this.onRemove(function(r){return function(){r.remove(),e.views.delete(t),e.views.delete(a)}}(s)),s.template=n,s.render(t),t}},{key:"mapEachTag",value:function(t){var e=this,r=t.getAttribute("cv-each"),i=t.getAttribute("cv-view");t.removeAttribute("cv-each"),t.removeAttribute("cv-view");var o=i?this.stringToClass(i):g,a=new DocumentFragment;Array.from(t.childNodes).map(function(t){return a.appendChild(t)});var s=p(r.split(":"),3),c=s[0],u=s[1],l=s[2],f=this.args.bindTo(c,function(r,i,s,c,f){e.viewLists.has(t)&&e.viewLists.get(t).remove();var h=new n.ViewList(a,u,r,e,l,o),p=function(){return h.remove()};e.onRemove(p),h.onRemove(function(){return e._onRemove.remove(p)});var d=e.args.bindTo(function(t,e,r,n){"_id"!==e&&(n&&delete h.subArgs[e],h.subArgs[e]=t)}),g=h.args.bindTo(function(t,r,n,i,o){"_id"!==r&&"value"!==r&&"___"!==r.substring(0,3)&&(i&&delete e.args[r],r in e.args&&(e.args[r]=t))});for(h.onRemove(d),h.onRemove(g),e.onRemove(d),e.onRemove(g);t.firstChild;)t.removeChild(t.firstChild);e.viewLists.set(t,h),h.render(t)});return this.onRemove(f),t}},{key:"mapIfTag",value:function(e){var r=this,n=e,i=e.getAttribute("cv-view"),o=n.getAttribute("cv-if"),a=!1,s=!1;n.removeAttribute("cv-view"),n.removeAttribute("cv-if");var c=i?this.stringToClass(i):g;"!"===o.substr(0,1)&&(o=o.substr(1),a=!0),"?"===o.substr(0,1)&&(o=o.substr(1),s=!0);var u=new DocumentFragment;Array.from(n.childNodes).map(function(t){return u.appendChild(t)});var l=this,f=new DocumentFragment,h=new c(this.args,l);this.onRemove(h.tags.bindTo(function(t,e){r.tags[e]=t})),h.template=u;var d=l.args,y=o;if(o.match(/\./)){var v=p(t.Bindable.resolve(l.args,o,!0),2);d=v[0],y=v[1]}h.render(f);var b=d.bindTo(y,function(t,r){s&&(t=null!==t&&void 0!==t),Array.isArray(t)&&(t=!!t.length),a&&(t=!t),t?e.appendChild(f):h.nodes.map(function(t){return f.appendChild(t)})},{wait:0,children:Array.isArray(d[y])});l.onRemove(b);var m=function(){d.isBound()||t.Bindable.clearBindings(d)};return l.onRemove(function(){b(),m(),l._onRemove.remove(b),l._onRemove.remove(m)}),this.onRemove(function(){h.remove(),l!==r&&l.remove()}),e}},{key:"compileIfTag",value:function(e){var r=e.getAttribute("cv-if"),n=!1;e.removeAttribute("cv-if"),"!"===r.substr(0,1)&&(r=r.substr(1),n=!0);var i=new DocumentFragment;return Array.from(e.childNodes).map(function(t){return i.appendChild(t.cloneNode(!0))}),function(o){var a=e.cloneNode(),s=new DocumentFragment,c=new g({},o);c.template=i,o.syncBind(c);var u=o.args,l=r;if(r.match(/\./)){var f=p(t.Bindable.resolve(o.args,r,!0),2);u=f[0],l=f[1]}var h=!1,d=u.bindTo(l,function(t,e){if(!h){var r=o.args[l]||n?a:s;return c.render(r),void(h=!0)}Array.isArray(t)&&(t=!!t.length),n&&(t=!t),t?a.appendChild(s):c.nodes.map(function(t){return s.appendChild(t)})});o.onRemove(d);var y=function(){u.isBound()||t.Bindable.clearBindings(u)};return c.onRemove(function(){d(),y(),o._onRemove.remove(d),o._onRemove.remove(y)}),a}}},{key:"mapTemplateTag",value:function(t){var e=t.getAttribute("cv-template");return t.removeAttribute("cv-template"),this.templates[e]=function(){return"TEMPLATE"===t.tagName?t.content.cloneNode(!0):new DocumentFragment(t.innerHTML)},this.rendered.then(function(){return t.remove()}),t}},{key:"mapSlotTag",value:function(t){var e=t.getAttribute("cv-slot"),r=this.templates[e];if(!r){for(var n=this;n&&!(r=n.templates[e]);)n=this.parent;if(!r)return void console.error("Template ".concat(e," not found."))}var i=r();for(t.removeAttribute("cv-slot");t.firstChild;)t.firstChild.remove();return t.appendChild(i),t}},{key:"syncBind",value:function(t){var e=this,r=this.args.bindTo(function(e,r,n,i){"_id"!==r&&t.args[r]!==e&&(t.args[r]=e)}),n=t.args.bindTo(function(t,r,n,i,o){if("_id"!==r){var a=t,s=o;a instanceof g&&(a=a.___ref___),s instanceof g&&(s=s.___ref___),a!==s&&s instanceof g&&o.remove(),r in e.args&&(e.args[r]=t)}});this.onRemove(r),this.onRemove(n),t.onRemove(function(){e._onRemove.remove(r),e._onRemove.remove(n)})}},{key:"postRender",value:function(t){}},{key:"attached",value:function(t){}},{key:"interpolatable",value:function(t){return!!String(t).match(this.interpolateRegex)}},{key:"uuid",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}},{key:"remove",value:function(){var t=this,e=function(){for(var e in t.tags)Array.isArray(t.tags[e])?(t.tags[e]&&t.tags[e].map(function(t){return t.remove()}),t.tags[e].splice(0)):(t.tags[e]&&t.tags[e].remove(),t.tags[e]=void 0);for(var r in t.nodes)t.nodes[r]&&t.nodes[r].dispatchEvent(new Event("cvDomDetached")),t.nodes[r]&&t.nodes[r].remove(),t.nodes[r]=void 0;t.nodes.splice(0),t.firstNode=t.lastNode=void 0};arguments.length>0&&void 0!==arguments[0]&&arguments[0]?e():requestAnimationFrame(e);var r,n,i=d(this._onRemove.items());try{for(i.s();!(r=i.n()).done;){var o=r.value;this._onRemove.remove(o),o()}}catch(t){i.e(t)}finally{i.f()}for(;n=this.cleanup.shift();)n&&n();var a,s=d(this.viewLists);try{for(s.s();!(a=s.n()).done;){var c=p(a.value,2);c[0];c[1].remove()}}catch(t){s.e(t)}finally{s.f()}for(var u in this.viewLists.clear(),this.timeouts)clearTimeout(this.timeouts[u].timeout),delete this.timeouts[u];for(var l in this.intervals)clearInterval(this.intervals[l].timeout),delete this.intervals[l];for(var l in this.frames)this.frames[l](),delete this.frames[l];this.removed=!0}},{key:"findTag",value:function(t){for(var e in this.nodes){var r;if(this.nodes[e].querySelector){if(this.nodes[e].matches(t))return new a.Tag(this.nodes[e],this,void 0,void 0,this);if(r=this.nodes[e].querySelector(t))return new a.Tag(r,this,void 0,void 0,this)}}}},{key:"findTags",value:function(t){var e=this;return this.nodes.filter(function(t){return t.querySelectorAll}).map(function(e){return h(e.querySelectorAll(t))}).flat().map(function(t){return new a.Tag(t,e,void 0,void 0,e)})}},{key:"onRemove",value:function(t){this._onRemove.add(t)}},{key:"update",value:function(){}},{key:"beforeUpdate",value:function(t){}},{key:"afterUpdate",value:function(t){}},{key:"stringTransformer",value:function(t){var e=this;return function(r){for(var n in t){for(var i=e,o=t[n];i&&!i[o];)i=i.parent;if(!i)return;r=i[t[n]](r)}return r}}},{key:"stringToClass",value:function(t){if(g.refClasses.has(t))return g.refClasses.get(t);var e=t.split("/"),n=e[e.length-1],i=r(t);return g.refClasses.set(t,i[n]),i[n]}},{key:"preventParsing",value:function(t){t[A]=!0}},{key:"toString",value:function(){return this.nodes.map(function(t){return t.outerHTML}).join(" ")}},{key:"listen",value:function(t,e,r,n){var i=this;if("string"==typeof t&&(n=r,r=e,e=t,t=this),t instanceof g)return this.listen(t.nodes,e,r,n);if(Array.isArray(t)){var o=t.map(function(t){return i.listen(t,e,r,n)});return function(){return o.map(function(t){return t()})}}if(t instanceof a.Tag)return this.listen(t.element,e,r,n);t.addEventListener(e,r,n);var s=function(){t.removeEventListener(e,r,n)},c=function(){s(),s=function(){}};return this.onRemove(function(){return c()}),c}}],[{key:"isView",value:function(){return g}}]),g}();e.View=P,Object.defineProperty(P,"templates",{value:new Map}),Object.defineProperty(P,"refClasses",{value:new Map})}()}),require.register("curvature/base/ViewList.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewList=void 0;var t=r("./Bindable"),n=r("./View"),i=r("./Bag");function o(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function e(r,o,a,c){var u=this,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.removed=!1,this.args=t.Bindable.makeBindable({}),this.args.value=t.Bindable.makeBindable(a||{}),this.subArgs=t.Bindable.makeBindable({}),this.views=[],this.cleanup=[],this.viewClass=f||n.View,this._onRemove=new i.Bag,this.template=r,this.subProperty=o,this.keyProperty=l,this.tag=null,this.paused=!1,this.parent=c,this.rendered=new Promise(function(t,e){Object.defineProperty(u,"renderComplete",{configurable:!1,writable:!0,value:t})}),this.willReRender=!1,this.args.___before(function(t,e,r,n,i){"bindTo"!=e&&(u.paused=!0)}),this.args.___after(function(t,e,r,n,i){"bindTo"!=e&&(u.paused=r.length>1,u.reRender())});var h=this.args.value.bindTo(function(t,e,r,n){if(!u.paused){var i=e;if("symbol"!==s(e))if(isNaN(e)&&(i="_"+e),n)for(var o in u.views[i]&&u.views[i].remove(),delete u.views[i],u.views)u.views[o].args[u.keyProperty]="string"!=typeof o?o:o.substr(1);else u.views[i]||u.willReRender?u.views[i]&&u.views[i].args&&(u.views[i].args[u.keyProperty]=e,u.views[i].args[u.subProperty]=t):(cancelAnimationFrame(u.willReRender),u.willReRender=requestAnimationFrame(function(){u.reRender()}))}});this._onRemove.add(h)}var r,a,u;return r=e,(a=[{key:"render",value:function(t){var e,r=this,n=[],i=o(this.views);try{var a=function(){var r=e.value;r.render(t),n.push(r.rendered.then(function(){return r}))};for(i.s();!(e=i.n()).done;)a()}catch(t){i.e(t)}finally{i.f()}this.tag=t,Promise.all(n).then(function(t){return r.renderComplete(t)})}},{key:"reRender",value:function(){var t=this;if(!this.paused&&this.tag){var e=[];for(var r in this.views)e[r]=this.views[r];var n=[];this.upDebind&&this.upDebind.map(function(t){return t&&t()}),this.downDebind&&this.downDebind.map(function(t){return t&&t()}),this.upDebind=[],this.downDebind=[];var i=1/0,o=1/0,a=function(r){var a=!1,s=r;isNaN(s)?s="_"+r:String(s).length&&(s=Number(s));for(var c=e.length-1;c>=0;c--)if(e[c]&&void 0!==t.args.value[r]&&t.args.value[r]===e[c].args[t.subProperty]){a=!0,n[s]=e[c],isNaN(s)||(i=Math.min(i,s),s>0&&(o=Math.min(o,s))),n[s].args[t.keyProperty]=r,delete e[c];break}if(!a){var u={},l=n[s]=new t.viewClass(u,t.parent);isNaN(s)||(i=Math.min(i,s),s>0&&(o=Math.min(o,s))),n[s].template=(t.template,Object,t.template),n[s].viewList=t,n[s].args[t.keyProperty]=r,n[s].args[t.subProperty]=t.args.value[r],t.upDebind[s]=u.bindTo(t.subProperty,function(e,r,n,i){var o=u[t.keyProperty];i?delete t.args.value[o]:t.args.value[o]=e}),t.downDebind[s]=t.subArgs.bindTo(function(t,e,r,n){n?delete u[e]:u[e]=t}),l.onRemove(function(){t.upDebind[s]&&t.upDebind[s](),t.downDebind[s]&&t.downDebind[s](),delete t.downDebind[s],delete t.upDebind[s]}),t._onRemove.add(function(){t.upDebind.filter(function(t){return t}).map(function(t){return t()}),t.upDebind.splice(0)}),t._onRemove.add(function(){t.downDebind.filter(function(t){return t}).map(function(t){return t()}),t.downDebind.splice(0)}),u[t.subProperty]=t.args.value[r]}};for(var s in this.args.value)a(s);for(var c in e){var u=!1;for(var l in n)if(e[c]===n[l]){u=!0;break}u||e[c].remove()}if(Array.isArray(this.args.value)){var f=0===i&&void 0!==n[1]&&n.length>1||o===1/0?i:o;this.rendered=function e(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=n.length-r-1;i>f&&void 0===n[i];)i--;return i<f?Promise.resolve():n[i]===t.views[i]?n[i].firstNode?e(Number(r)+1):(n[i].render(t.tag,n[i+1]),n[i].rendered.then(function(){return e(Number(r)+1)})):(n[i].render(t.tag,n[i+1]),t.views.splice(i,0,n[i]),n[i].rendered.then(function(){return e(Number(r)+1)}))}()}else{var h=[],p=Object.assign({},n),d=function(e){if(delete p[e],n[e].firstNode&&n[e]===t.views[e])return"continue";n[e].render(t.tag),h.push(n[e].rendered.then(function(){return n[e]}))};for(var g in n)d(g);for(var y in p)delete this.args.views[y],p.remove();this.rendered=Promise.all(h)}for(var v in this.views=n,n)isNaN(v)?n[v].args[this.keyProperty]=v.substr(1):n[v].args[this.keyProperty]=v;this.willReRender=!1}}},{key:"pause",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(var e in this.views)this.views[e].pause(t)}},{key:"onRemove",value:function(t){this._onRemove.add(t)}},{key:"remove",value:function(){for(var e in this.views)this.views[e].remove();var r=this._onRemove.items();for(var n in r)this._onRemove.remove(r[n]),r[n]();for(;this.cleanup.length;)this.cleanup.pop()();for(this.views=[];this.tag&&this.tag.firstChild;)this.tag.removeChild(this.tag.firstChild);this.subArgs&&t.Bindable.clearBindings(this.subArgs),t.Bindable.clearBindings(this.args),this.args.value&&!this.args.value.isBound()&&t.Bindable.clearBindings(this.args.value),this.removed=!0}}])&&c(r.prototype,a),u&&c(r,u),e}();e.ViewList=u}()}),require.register("curvature/input/Keyboard.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Keyboard=void 0;var t=r("../base/Bindable");function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}var o=function(){function e(){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxDecay=120,this.comboTime=500,this.listening=!1,this.focusElement=document.body,Object.defineProperty(this,"combo",{value:t.Bindable.make([])}),Object.defineProperty(this,"whichs",{value:t.Bindable.make({})}),Object.defineProperty(this,"codes",{value:t.Bindable.make({})}),Object.defineProperty(this,"keys",{value:t.Bindable.make({})}),Object.defineProperty(this,"pressedWhich",{value:t.Bindable.make({})}),Object.defineProperty(this,"pressedCode",{value:t.Bindable.make({})}),Object.defineProperty(this,"pressedKey",{value:t.Bindable.make({})}),Object.defineProperty(this,"releasedWhich",{value:t.Bindable.make({})}),Object.defineProperty(this,"releasedCode",{value:t.Bindable.make({})}),Object.defineProperty(this,"releasedKey",{value:t.Bindable.make({})}),Object.defineProperty(this,"keyRefs",{value:t.Bindable.make({})}),document.addEventListener("keyup",function(t){r.listening&&(r.focusElement&&document.activeElement!==r.focusElement||(t.preventDefault(),r.releasedWhich[t.which]=Date.now(),r.releasedCode[t.code]=Date.now(),r.releasedKey[t.key]=Date.now(),r.whichs[t.which]=-1,r.codes[t.code]=-1,r.keys[t.key]=-1))}),document.addEventListener("keydown",function(t){r.listening&&(r.focusElement&&document.activeElement!==r.focusElement||(t.preventDefault(),t.repeat||(r.combo.push(t.code),clearTimeout(r.comboTimer),r.comboTimer=setTimeout(function(){return r.combo.splice(0)},r.comboTime),r.pressedWhich[t.which]=Date.now(),r.pressedCode[t.code]=Date.now(),r.pressedKey[t.key]=Date.now(),r.keys[t.key]>0||(r.whichs[t.which]=1,r.codes[t.code]=1,r.keys[t.key]=1))))});var n=function(t){for(var e in r.keys)r.keys[e]<0||(r.releasedKey[e]=Date.now(),r.keys[e]=-1);for(var n in r.codes)r.codes[n]<0||(r.releasedCode[n]=Date.now(),r.codes[n]=-1);for(var i in r.whichs)r.whichs[i]<0||(r.releasedWhich[i]=Date.now(),r.whichs[i]=-1)};window.addEventListener("blur",n),window.addEventListener("visibilitychange",function(){"visible"!==document.visibilityState&&n()})}return i(e,null,[{key:"get",value:function(){return this.instance=this.instance||t.Bindable.make(new this)}}]),i(e,[{key:"getKeyRef",value:function(e){return this.keyRefs[e]=this.keyRefs[e]||t.Bindable.make({})}},{key:"getKeyTime",value:function(t){var e=this.releasedKey[t],r=this.pressedKey[t];return r?!e||e<r?Date.now()-r:-1*(Date.now()-e):0}},{key:"getCodeTime",value:function(t){var e=this.releasedCode[t],r=this.pressedCode[t];return r?!e||e<r?Date.now()-r:-1*(Date.now()-e):0}},{key:"getWhichTime",value:function(t){var e=this.releasedWhich[t],r=this.pressedWhich[t];return r?!e||e<r?Date.now()-r:-1*(Date.now()-e):0}},{key:"getKey",value:function(t){return this.keys[t]?this.keys[t]:0}},{key:"getKeyCode",value:function(t){return this.codes[t]?this.codes[t]:0}},{key:"update",value:function(){for(var t in this.keys)this.keys[t]>0?this.keys[t]++:this.keys[t]>-this.maxDecay?this.keys[t]--:delete this.keys[t];for(var t in this.codes){var e=this.releasedCode[t],r=this.pressedCode[t],n=this.getKeyRef(t);if(this.codes[t]>0){if(n.frames=this.codes[t]++,n.time=r?Date.now()-r:0,n.down=!0,!e||e<r)return;return-1*(Date.now()-e)}this.codes[t]>-this.maxDecay?(n.frames=this.codes[t]--,n.time=e-Date.now(),n.down=!1):(n.frames=0,n.time=0,n.down=!1,delete this.codes[t])}for(var t in this.whichs)this.whichs[t]>0?this.whichs[t]++:this.whichs[t]>-this.maxDecay?this.whichs[t]--:delete this.whichs[t]}}]),e}();e.Keyboard=o}()}),require.register("curvature/mixin/EventTargetMixin.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventTargetMixin=void 0;var t,n=r("../base/Mixin");function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=Symbol("Target"),a=(i(t={},n.Mixin.Constructor,function(){try{this[o]=new EventTarget}catch(t){this[o]=document.createDocumentFragment()}}),i(t,"dispatchEvent",function(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0];(t=this[o]).dispatchEvent.apply(t,r);var a="on".concat(i.type[0].toUpperCase()+i.type.slice(1));return"function"==typeof this[a]&&this[a](i),i.returnValue}),i(t,"addEventListener",function(){var t;(t=this[o]).addEventListener.apply(t,arguments)}),i(t,"removeEventListener",function(){var t;(t=this[o]).removeEventListener.apply(t,arguments)}),t);e.EventTargetMixin=a}()}),require.register("curvature/mixin/PromiseMixin.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PromiseMixin=void 0;var t,n=r("../base/Mixin");function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=Symbol("Promise"),a=Symbol("Accept"),s=Symbol("Reject"),c=(i(t={},n.Mixin.Constructor,function(){var t=this;this[o]=new Promise(function(e,r){t[a]=e,t[s]=r})}),i(t,"then",function(){var t;return(t=this[o]).then.apply(t,arguments)}),i(t,"catch",function(){var t;return(t=this[o]).catch.apply(t,arguments)}),i(t,"finally",function(){var t;return(t=this[o]).finally.apply(t,arguments)}),t);e.PromiseMixin=c,Object.defineProperty(c,"Reject",{value:s}),Object.defineProperty(c,"Accept",{value:a})}()}),require.register("World.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.World=void 0;var n=e("curvature/base/Bag"),i=e("curvature/base/Bindable"),o=e("tileMap/TileMap");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,"tileMap",new o.TileMap),this.viewports=new n.Bag(function(t,r,n){switch(n){case BAG.ITEM_ADDED:t.world=e;break;case BAG.ITEM_REMOVED:t.world=null}}),this.actors=new n.Bag(function(t,r,n){switch(n){case BAG.ITEM_ADDED:t.world=e;break;case BAG.ITEM_REMOVED:t.world=null}})}var e,r,i;return e=t,(r=[{key:"getOnScreenObjects",value:function(t){}},{key:"update",value:function(){}}])&&a(e.prototype,r),i&&a(e,i),t}();t.World=c,s(c,"globals",i.Bindable.make({}))}),require.register("actor/BrokenMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BrokenMonitor=void 0;var i=e("./PointActor"),o=(e("../actor/Explosion"),e("../actor/Monitor"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-monitor actor-monitor-broken",t.args.width=28,t.args.height=32,t}return e=h,(r=[{key:"collideA",value:function(t){return t instanceof o.Monitor?(this.viewport&&this.viewport.actors.remove(this),!1):(s(l(h.prototype),"collideA",this).call(this,t),!0)}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&a(e.prototype,r),n&&a(e,n),h}();t.BrokenMonitor=f}),require.register("actor/Coin.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Coin=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-coin",t.args.width=32,t.args.height=32,t.args.float=-1,t.args.gone=!1,t}return e=f,(r=[{key:"update",value:function(){a(u(f.prototype),"update",this).call(this),this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/mario/smw_coin.wav"),this.sample.volume=1)}},{key:"collideA",value:function(t){var e=this;if(a(u(f.prototype),"collideA",this).call(this,t),!this.args.gone){if(this.args.type="actor-item actor-coin collected",!this.args.gone){this.viewport.args.audio&&this.sample&&this.sample.play(),this.onTimeout(240,function(){e.args.type="actor-item actor-coin collected gone"}),this.onTimeout(480,function(){e.viewport.actors.remove(e),e.remove()});var r=this.x,n=this.y;this.viewport.spawn.add({time:Date.now()+7500,object:new f({x:r,y:n})}),t.args.owner?t.args.owner.args.coins+=1:t.occupant?t.occupant.args.coins+=1:t.args.coins+=1}this.args.gone=!0}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Coin=l}),require.register("actor/DrillCar.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DrillCar=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-drill-car",t.args.width=93,t.args.height=48,t.removeTimer=null,t.args.gSpeedMax=25,t.args.decel=.3,t.args.accel=1.75,t.args.seatHeight=30,t.args.skidTraction=.5,t.dustCount=0,t.args.particleScale=2,t}return e=h,(r=[{key:"collideA",value:function(t){return!!t.controllable&&(!(t.y>=this.y)&&!t.isVehicle)}},{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.backSprite=new o.Tag('<div class = "sprite-back sprite">'),this.drill=new o.Tag('<div class = "drill-car-drill">'),this.seat=new o.Tag('<div class = "drill-car-seat">'),this.windsheild=new o.Tag('<div class = "drill-car-windsheild">'),this.copterCap=new o.Tag('<div class = "drill-car-copter-cap">'),this.copterBladeA=new o.Tag('<div class = "drill-car-copter-blade-a">'),this.copterBladeB=new o.Tag('<div class = "drill-car-copter-blade-b">'),this.frontWheelA=new o.Tag('<div class = "drill-car-tire drill-car-tire-front-a">'),this.frontWheelB=new o.Tag('<div class = "drill-car-tire drill-car-tire-front-b">'),this.backWheelA=new o.Tag('<div class = "drill-car-tire drill-car-tire-back-a">'),this.backWheelB=new o.Tag('<div class = "drill-car-tire drill-car-tire-back-b">'),this.sprite.appendChild(this.drill.node),this.backSprite.appendChild(this.copterCap.node),this.backSprite.appendChild(this.copterBladeA.node),this.backSprite.appendChild(this.copterBladeB.node),this.sprite.appendChild(this.windsheild.node),this.backSprite.appendChild(this.seat.node),this.sprite.appendChild(this.frontWheelA.node),this.backSprite.appendChild(this.frontWheelB.node),this.sprite.appendChild(this.backWheelA.node),this.backSprite.appendChild(this.backWheelB.node),this.box.appendChild(this.backSprite.node)}},{key:"update",value:function(){var t=this.args.falling;if(this.viewport.args.audio&&!this.flyingSound&&(this.flyingSound=new Audio("/Sonic/drill-car-copter.wav"),this.flyingSound.volume=.35+-.2*Math.random(),this.flyingSound.loop=!0),this.flyingSound.paused||(this.flyingSound.volume=.25+-.2*Math.random()),this.flyingSound.currentTime>.2&&(this.flyingSound.currentTime=0),this.box){if(t)this.args.flying?this.box.setAttribute("data-animation","flying"):this.args.falling&&(this.flyingSound.pause(),this.box.setAttribute("data-animation","jumping"));else{this.flyingSound.pause();var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;if(this.dustCount>0&&this.dustCount--,Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5){this.box.setAttribute("data-animation","skidding");var a=this.viewport,c=new o.Tag('<div class = "particle-dust">'),u=this.rotatePoint(this.args.gSpeed,6);c.style({"--x":u[0]+this.x,"--y":u[1]+this.y,"z-index":0,opacity:2*Math.random});var f=new o.Tag('<div class = "particle-dust">'),p=this.rotatePoint(this.args.gSpeed+40*this.args.direction,6);f.style({"--x":p[0]+this.x,"--y":p[1]+this.y,"z-index":0,opacity:2*Math.random}),a.particles.add(c),a.particles.add(f),setTimeout(function(){a.particles.remove(c),a.particles.remove(f)},320)}else this.args.moving&&n>.75*i?this.box.setAttribute("data-animation","running"):this.args.moving&&n?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}0==this.args.copterCoolDown?this.args.ySpeed>5&&(this.flyingSound.pause(),this.args.flying=!1):this.args.copterCoolDown>0&&this.args.copterCoolDown--,s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"command_0",value:function(){if(!this.args.falling)return this.args.copterCoolDown=15,void s(l(h.prototype),"command_0",this).call(this);this.args.copterCoolDown>0||this.args.ySpeed>1&&(this.args.flying||this.flyingSound.play(),this.args.flying=!0,0==this.args.copterCoolDown&&(this.args.copterCoolDown=7),this.args.ySpeed=-1,this.args.float=8)}},{key:"solid",get:function(){return!0}},{key:"isVehicle",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),h}();t.DrillCar=f}),require.register("actor/EggMobile.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EggMobile=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-vehicle actor-eggmobile",t.args.accel=.15,t.args.decel=.8,t.args.gSpeedMax=20,t.args.xSpeedMax=20,t.args.ySpeedMax=20,t.args.jumpForce=12,t.args.gravity=.6,t.args.width=54,t.args.height=20,t.args.float=-1,t.args.yMargin=42,t.args.falling=!0,t.args.flying=!0,t}return e=f,(r=[{key:"collideA",value:function(t){return!!t.controllable&&(!(t.y>=this.y)&&!t.isVehicle)}},{key:"update",value:function(){if(Math.abs(this.yAxis)>.1){if(Math.abs(this.args.ySpeed)<this.args.ySpeedMax){var t=this.args.ySpeed;Math.sign(this.yAxis)===Math.sign(this.args.ySpeed)?t+=this.yAxis*this.args.accel*3:t+=this.yAxis*this.args.accel*6,t=Math.floor(1e3*t)/1e3,this.args.ySpeed=t}}else this.args.ySpeed=this.args.ySpeed*this.args.decel;this.xAxis||(this.args.xSpeed=this.args.xSpeed*this.args.decel),a(u(f.prototype),"update",this).call(this),this.args.falling=!0,this.args.flying=!0,this.args.mode=0}},{key:"solid",get:function(){return!0}},{key:"isVehicle",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.EggMobile=l}),require.register("actor/Eggman.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Eggman=void 0;var i=e("./PointActor");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-eggman",t.args.accel=.15,t.args.decel=.3,t.args.gSpeedMax=10,t.args.jumpForce=12,t.args.gravity=.6,t.args.width=48,t.args.height=55,t}return e=f,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","skidding"):n>i/2?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.args.crouching||this.standingOn&&this.standingOn.isVehicle?this.box.setAttribute("data-animation","crouching"):this.box.setAttribute("data-animation","standing")}a(u(f.prototype),"update",this).call(this)}else a(u(f.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Eggman=l}),require.register("actor/Eggrobo.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Eggrobo=void 0;var i=e("./PointActor"),o=e("./Projectile"),a=e("curvature/base/Tag");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,i.PointActor);var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).args.type="actor-item actor-eggrobo",t.args.accel=.125,t.args.decel=.3,t.args.gSpeedMax=20,t.args.jumpForce=13,t.args.gravity=.6,t.args.width=48,t.args.height=57,t}return e=p,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.flame=new a.Tag('<div class = "eggrobo-flame">'),this.muzzleFlash=new a.Tag('<div class = "eggrobo-muzzle-flash">'),this.sprite.appendChild(this.flame.node),this.sprite.appendChild(this.muzzleFlash.node)}},{key:"update",value:function(){var t=this.args.falling;if(this.viewport.args.audio&&!this.shootingSample&&(this.shootingSample=new Audio("/Sonic/shot-fired.wav"),this.thrusterSound=new Audio("/Sonic/mecha-sonic-thruster.wav"),this.thrusterSound.loop=!0),this.thrusterSound.currentTime>.4+Math.random()/10&&(this.thrusterSound.currentTime=.05),this.thrusterSound.volume=.2+-.05*Math.random(),this.box){if(t)this.args.crouching=!1,this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?(this.thrusterSound.pause(),this.box.setAttribute("data-animation","skidding")):n>i/2?(this.thrusterSound.pause(),this.box.setAttribute("data-animation","running")):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.args.crouching||this.standingOn&&this.standingOn.isVehicle?this.box.setAttribute("data-animation","crouching"):this.box.setAttribute("data-animation","standing")}this.args.falling||(this.args.flying=!1),this.args.flying?this.box.setAttribute("data-animation","flying"):this.args.falling&&this.box.setAttribute("data-animation","jumping"),this.args.shotCoolDown>0&&this.args.shotCoolDown--,0==this.args.rocketCoolDown&&this.thrusterSound.pause(),this.args.rocketCoolDown>0&&this.args.rocketCoolDown--,0==this.args.rocketCoolDown&&(this.args.flying=!1),c(f(p.prototype),"update",this).call(this)}else c(f(p.prototype),"update",this).call(this)}},{key:"command_0",value:function(){if(!this.args.falling)return this.args.rocketCoolDown=5,void c(f(p.prototype),"command_0",this).call(this);(this.args.ySpeed>1||this.args.flying)&&(this.args.flying=!0,this.args.rocketCoolDown<=1&&(this.thrusterSound.play(),this.args.rocketCoolDown=3),this.args.ySpeed=0,this.args.float=4)}},{key:"command_2",value:function(){var t=this;if(!(this.args.shotCoolDown>0)){var e,r,n,i=Math.sign(this.args.direction),a=this.args.groundAngle;switch(this.args.mode){case 0:n=-a-Math.PI/2+Math.PI/4*i,r=-a;break;case 1:n=-a+Math.PI/4*i,r=-a+Math.PI/2;break;case 2:n=-a+Math.PI/2+Math.PI/4*i,r=-a-Math.PI;break;case 3:n=-a-Math.PI+Math.PI/4*i,r=-a-Math.PI/2}e=[50*Math.cos(n),50*Math.sin(n)],(this.args.falling||this.args.crouching)&&(r=0,e=[26*i,-26]);var s=new o.Projectile({x:this.args.x+e[0],y:this.args.y+e[1],owner:this,direction:this.args.direction});s.impulse(75,r+(i<0?Math.PI:0)),this.viewport.actors.add(s),this.box.setAttribute("data-shooting","true"),this.onTimeout(140,function(){t.box.setAttribute("data-shooting","false")}),this.viewport.args.audio&&this.shootingSample&&(this.shootingSample.volume=.6+-.3*Math.random(),this.shootingSample.currentTime=0,this.shootingSample.play()),this.args.shotCoolDown=18}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&s(e.prototype,r),n&&s(e,n),p}();t.Eggrobo=h}),require.register("actor/Emerald.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Emerald=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-emerald emerald-"+(t.args.color||"white"),t.args.width=12,t.args.height=12,t}return e=f,(r=[{key:"update",value:function(){a(u(f.prototype),"update",this).call(this),this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/S3K_9C.wav"),this.sample.volume=.25+.5*Math.random())}},{key:"collideA",value:function(t){a(u(f.prototype),"collideA",this).call(this,t),this.args.gone||(this.args.type="actor-item actor-emerald collected emerald-"+(this.args.color||"white"),this.args.gone||(this.viewport.args.audio&&this.sample&&this.sample.play(),this.args.type="actor-item actor-emerald collected gone emerald-"+(this.args.color||"white"),this.viewport.actors.remove(this),this.remove(),t.args.owner?t.args.owner.args.emeralds+=1:t.occupant?t.occupant.args.emeralds+=1:t.args.emeralds+=1),this.args.gone=!0)}},{key:"solid",get:function(){return!0}},{key:"effect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Emerald=l}),require.register("actor/Explosion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Explosion=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-explosion",t.args.width=48,t.args.height=48,t.args.float=-1,t.removeTimer=null,t}return e=f,(r=[{key:"update",value:function(){var t=this;if(a(u(f.prototype),"update",this).call(this),!this.removeTimer){var e=this.viewport;this.removeTimer=this.onTimeout(360,function(){e.actors.remove(t)})}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Explosion=l}),require.register("actor/Knuckles.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Knuckles=void 0;var i=e("./PointActor");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-knuckles",t.args.accel=.18,t.args.decel=.7,t.args.gSpeedMax=25,t.args.jumpForce=14,t.args.gravity=.7,t.args.skidTraction=.5,t.args.width=16,t.args.height=41,t.args.skidTraction=.8,t}return e=f,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.args.flying?this.box.setAttribute("data-animation","flying"):this.box.setAttribute("data-animation","jumping");else{var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;this.args.knucklesFlyCoolDown=15,this.args.flying=!1,Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","skidding"):n>i/2?this.box.setAttribute("data-animation","running"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}this.args.knucklesFlyCoolDown>0&&this.args.knucklesFlyCoolDown--,a(u(f.prototype),"update",this).call(this)}else a(u(f.prototype),"update",this).call(this)}},{key:"command_0",value:function(){this.args.falling?this.args.knucklesFlyCoolDown>0||(this.args.ySpeed>1&&(this.args.flying=!0),this.args.flying&&(this.args.ySpeed>0&&(this.args.ySpeed=0),this.args.ySpeed<1&&(this.args.ySpeed+=1),this.args.ySpeed>1&&(this.args.ySpeed-=1),this.xAxis||(this.args.xSpeed+=.15625*this.args.direction),this.args.float=3)):a(u(f.prototype),"command_0",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Knuckles=l}),require.register("actor/LayerSwitch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LayerSwitch=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(r,i.PointActor);var e=c(r);function r(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).args.type="actor-item actor-layer-switch",t.args.width=32,t.args.height=32,t.args.float=-1,t}return a(r,[{key:"onAttach",value:function(t){t.preventDefault(t)}}],[{key:"fromDef",value:function(t){var e=u(l(r),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e}}]),a(r,[{key:"collideA",value:function(t){var e=!!Number(this.args.back);t.args.gSpeed>=0?t.args.layer=e?1:2:t.args.gSpeed<0&&(t.args.layer=e?2:1)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}]),r}();t.LayerSwitch=f}),require.register("actor/MarbleBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MarbleBlock=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-block-marble",t.args.width=32,t.args.height=32,t}return e=f,(r=[{key:"update",value:function(){a(u(f.prototype),"update",this).call(this),0===this.scanBottomEdge()&&(this.args.falling=!0)}},{key:"collideA",value:function(t,e){a(u(f.prototype),"collideA",this).call(this,t,e);var r=t.args.gSpeed||t.args.xSpeed;if(1===e&&r<=0)return!1;if(3===e&&r>=0)return!1;if(1===e||3===e){if(!r)return!0;var n=this.viewport.tileMap,i=1===e?1:3===e&&-1;if(n.getSolid(this.x+this.args.width/2*i,this.y))return!0;var o=this.scanBottomEdge(i);if(i>0&&0===o)this.args.falling=!0;else if(i<0&&0===o)this.args.falling=!0;else if(!this.args.falling||o>0){var s=this.findNextStep(i);if(!s[1]){var c=s[0]||i;return this.args.x+=c,0===o}return!0}}return!0}},{key:"scanBottomEdge",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=this.viewport.tileMap;return this.castRay(this.args.width,e<0?Math.PI:0,[-e*(this.args.width/2),0],function(e,n){if(!t.viewport.actorsAtPoint(n[0],n[1]+1).filter(function(e){return e.args!==t.args}).length&&!r.getSolid(n[0],n[1]+1,t.args.layer))return e})}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!0}},{key:"rotateLock",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.MarbleBlock=l}),require.register("actor/MechaSonic.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MechaSonic=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-mecha-sonic",t.args.accel=.3,t.args.decel=.3,t.args.gSpeedMax=40,t.args.jumpForce=15,t.args.gravity=.7,t.args.takeoffPlayed=!1,t.args.width=48,t.args.height=63,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite")}},{key:"update",value:function(){var t=this,e=this.args.falling;if(this.box){this.args.accel=.3;var r=this.args.direction,n=this.args.gSpeed,i=Math.abs(n);this.flame||(this.sparks=new o.Tag('<div class = "mecha-sonic-sparks">'),this.flame=new o.Tag('<div class = "mecha-sonic-flame">'),this.sprite.appendChild(this.sparks.node),this.sprite.appendChild(this.flame.node)),this.viewport.args.audio&&!this.thrusterSound&&(this.takeoffSound=new Audio("/Sonic/mecha-sonic-takeoff.wav"),this.thrusterSound=new Audio("/Sonic/mecha-sonic-thruster.wav"),this.scrapeSound=new Audio("/Sonic/mecha-sonic-scrape.wav"),this.thrusterCloseSound=new Audio("/Sonic/mecha-sonic-thruster-close.wav"),this.thrusterCloseSound.volume=.25,this.takeoffSound.volume=.5,this.scrapeSound.volume=.1,this.thrusterSound.loop=!0,this.scrapeSound.loop=!0),this.thrusterSound&&(this.thrusterSound.volume=.15+-.05*Math.random(),this.thrusterSound.currentTime>1.5&&(this.thrusterSound.currentTime=.5),this.scrapeSound.currentTime>1.5&&(this.scrapeSound.currentTime=.5)),e?(this.scrapeSound.pause(),"jumping"!==this.box.getAttribute("data-animation")&&(this.box.setAttribute("data-animation","curling"),this.onTimeout(128,function(){t.args.falling&&t.box.setAttribute("data-animation","jumping")}))):(Math.sign(this.args.gSpeed)!==r&&Math.abs(this.args.gSpeed-r)>5?(this.scrapeSound.play(),this.box.setAttribute("data-animation","skidding")):i>=35?(this.scrapeSound.pause(),this.box.setAttribute("data-animation","running2"),this.thrusterSound.play(),this.args.takeoffPlayed||(this.args.takeoffPlayed=!0,this.takeoffSound.play()),this.args.accel=.75,i>75&&(this.args.accel=.01)):i>=10?(this.scrapeSound.play(),this.box.setAttribute("data-animation","running")):this.args.moving&&n?(this.scrapeSound.play(),this.box.setAttribute("data-animation","walking")):(this.scrapeSound.pause(),this.box.setAttribute("data-animation","standing")),i<35&&(this.args.takeoffPlayed&&this.thrusterCloseSound.play(),this.args.takeoffPlayed=!1,this.thrusterSound.pause())),s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),h}();t.MechaSonic=f}),require.register("actor/Monitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Monitor=void 0;var i=e("./PointActor"),o=e("../actor/Explosion"),a=e("../actor/Projectile"),s=e("../actor/BrokenMonitor");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(d,i.PointActor);var e,r,n,p=f(d);function d(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).args.type="actor-item actor-monitor",t.args.width=28,t.args.height=32,t.gone=!1,t}return e=d,(r=[{key:"update",value:function(){u(h(d.prototype),"update",this).call(this),this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/object-destroyed.wav"),this.sample.volume=.6+-.3*Math.random())}},{key:"collideA",value:function(t,e){return u(h(d.prototype),"collideA",this).call(this,t,e),this.args.falling||t.occupant?(this.pop(t),!1):2!==e&&(!this.args.falling||-1===this.args.float)&&t.args.ySpeed>0&&t.y<this.y&&this.viewport&&!this.gone?(this.gone=!0,t.args.ySpeed*=-1,t.args.falling=!0,this.args.falling&&Math.abs(t.args.ySpeed)>0&&(t.args.xSpeed*=-1),this.pop(t),!1):!((1===e||3===e)&&(Math.abs(t.args.xSpeed)>15||Math.abs(t.args.gSpeed)>15||t instanceof a.Projectile)&&this.viewport&&!this.gone)||(this.pop(t),!1)}},{key:"pop",value:function(t){var e=this,r=this.viewport;if(r){var n=new s.BrokenMonitor({x:this.x,y:this.y+30});r.actors.remove(this),setTimeout(function(){r.actors.add(n),r.actors.add(new o.Explosion({x:e.x,y:e.y+8}))},0),setTimeout(function(){r.actors.remove(n),n.remove()},5e3),t.args.owner?t.args.owner.args.rings+=10:t.occupant?t.occupant.args.rings+=10:t.args.rings+=10,r.args.audio&&this.sample&&this.sample.play()}}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!0}}])&&c(e.prototype,r),n&&c(e,n),d}();t.Monitor=p}),require.register("actor/NuclearSuperball.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NuclearSuperball=void 0;var i=e("./PointActor");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return c.call.apply(c,[this].concat(e))}return e=u,(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),u}();t.NuclearSuperball=u}),require.register("actor/PointActor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PointActor=void 0;var i=e("curvature/base/Bindable"),o=e("curvature/base/View"),a=e("curvature/base/Tag");function s(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return e&&l(t.prototype,e),r&&l(t,r),t}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=y(t);if(e){var i=y(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d(this,r)}}function d(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?g(t):e}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=100,b=0,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(r,o.View);var e=p(r);function r(){var t,n,o,s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];t=e.call.apply(e,[this].concat(u)),n=g(t),s='<div\n\t\tclass  = "point-actor [[type]]"\n\t\tstyle  = "\n\t\t\tdisplay:[[display]];\n\t\t\t--angle:[[angle]];\n\t\t\t--airAngle:[[airAngle]];\n\t\t\t--ground-angle:[[groundAngle]];\n\t\t\t--air-angle:[[airAngle]];\n\t\t\t--height:[[height]];\n\t\t\t--width:[[width]];\n\t\t\t--x:[[x]];\n\t\t\t--y:[[y]];\n\t\t"\n\t\tdata-camera-mode = "[[cameraMode]]"\n\t\tdata-colliding   = "[[colliding]]"\n\t\tdata-falling   = "[[falling]]"\n\t\tdata-facing    = "[[facing]]"\n\t\tdata-angle     = "[[angle|rad2deg]]"\n\t\tdata-mode      = "[[mode]]"\n\t\tdata-layer     = "[[layer]]"\n\t><div class = "sprite"></div></div>',(o="template")in n?Object.defineProperty(n,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[o]=s,t.region=null,t.args.type="actor-generic",t.args.display=t.args.display||"initial",t.args.emeralds=0,t.args.rings=0,t.args.coins=0,t.args.yMargin=0,t.args.cameraMode="normal",t.args.layer=1,t.args.moving=!1,t.args.x=t.args.x||1280,t.args.y=t.args.y||32,t.args.width=t.args.width||1,t.args.height=t.args.height||1,t.args.direction=t.args.direction||1,t.args.gSpeed=t.args.gSpeed||0,t.args.xSpeed=t.args.xSpeed||0,t.args.ySpeed=t.args.ySpeed||0,t.args.angle=t.args.angle||0,t.args.groundAngle=0,t.args.airAngle=0,t.lastAngles=[0,0],t.angleAvg=32,t.args.xSpeedMax=512,t.args.ySpeedMax=512,t.maxStep=4,t.backStep=0,t.frontStep=0,t.args.skidTraction=5,t.args.falling=!0,t.args.running=!1,t.args.crawling=!1,t.args.rotateFixed=!1,t.args.mode=b,t.xAxis=0,t.yAxis=0,t.willStick=!1,t.stayStuck=!1,t.args.ignore=t.args.ignore||0,t.args.float=t.args.float||0,t.colliding=!1,t.args.bindTo(["xSpeed"],function(e){t.args.airAngle=Math.atan2(t.args.ySpeed,e)}),t.args.bindTo(["ySpeed"],function(e){t.args.airAngle=Math.atan2(e,t.args.xSpeed)}),t.impulseMag=null,t.impulseDir=null,t.args.gSpeedMax=v,t.args.jumpForce=14,t.args.stopped=0,t.args.gravity=.65,t.args.decel=.85,t.args.accel=.3,t.args.particleScale=1;var f=i.Bindable.make(g(t));return f.debindGround=null,f.bindTo("region",function(e,r,n){if(e){var i=e.args.drag;if(t.args.xSpeed*=i,t.args.ySpeed*=i,t.args.gSpeed*=i,t.viewport){var o=t.viewport,s=new a.Tag('<div class = "particle-splash">');s.style({"--x":t.x,"--y":e.y-e.args.height,"z-index":5,opacity:Math.random,"--particleScale":t.args.particleScale}),o.particles.add(s),setTimeout(function(){return o.particles.remove(s)},140*(t.args.particleScale||1))}}}),f.bindTo("standingOn",function(e,r,n){if(f.debindGroundX&&f.debindGroundX(),f.debindGroundY&&f.debindGroundY(),f.debindGroundL&&f.debindGroundL(),t.controllable){var i=n[r];if(e){if(e.isVehicle){f.debindGroundX=e.args.bindTo("x",function(r,n){var i=e.args.seatHeight||e.args.height||0,o=0*Math.cos(e.realAngle)-i*Math.sin(e.realAngle),a=i*Math.cos(e.realAngle)+0*Math.sin(e.realAngle);t.args.x=o+r,t.args.y=a+e.y}),f.debindGroundY=e.args.bindTo("y",function(r,n){var i=e.args.seatHeight||e.args.height||0,o=0*Math.cos(e.realAngle)-i*Math.sin(e.realAngle),a=i*Math.cos(e.realAngle)+0*Math.sin(e.realAngle);t.args.x=o+e.x,t.args.y=a+r}),f.debindGroundL=e.args.bindTo("layer",function(e,r){t.args.layer=e});var o=e.occupant;e.occupant=g(t),e.args.yMargin=t.args.height,o&&(o.standingOn=null,o.args.gSpeed=0,o.args.xSpeed=8*t.args.direction,o.args.ySpeed=-12,o.args.falling=!0),t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=0}else f.debindGroundX=e.args.bindTo("x",function(r,n){t.args.x+=r-e.args.x}),f.debindGroundY=e.args.bindTo("y",function(r,n){t.args.y=r-e.args.height}),f.debindGroundL=e.args.bindTo("layer",function(e,r){t.args.layer=e});i&&i.isVehicle&&(i.occupant===g(t)&&(i.occupant=null,i.stayStuck=!1,i.willStick=!1),i.xAxis=0,i.yAxis=0)}else i&&i.isVehicle&&(i.occupant===g(t)&&(i.occupant=null,i.stayStuck=!1,i.willStick=!1),i.xAxis=0,i.yAxis=0)}}),d(t,f)}return f(r,null,[{key:"fromDef",value:function(t){new this;var e={x:t.x+16,y:t.y-1,visible:t.visible,name:t.name};for(var r in t.properties){var n=t.properties[r];e[n.name]=n.value}return new this(Object.assign({},e))}}]),f(r,[{key:"onRendered",value:function(){var t=this;this.listen("click",function(){if(t.controllable){t.viewport.nextControl=i.Bindable.make(t);var e,r=function(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(t.viewport.tags.currentActor.options);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.value===t.args.name&&(t.viewport.tags.currentActor.value=n.value)}}catch(t){r.e(t)}finally{r.f()}t.args.ySpeed=0}})}},{key:"updateStart",value:function(){this.colliding=!1,this.restingOn=null}},{key:"updateEnd",value:function(){}},{key:"update",value:function(){var t=this;if(this.viewport&&!this.removed){if(this.standingOn&&this.standingOn.isVehicle){var e=this.standingOn;return this.processInput(),this.willJump&&this.yAxis>=0&&(this.willJump=!1,this.standingOn.command_0()),this.willJump&&this.yAxis<0&&(this.willJump=!1,this.standingOn=!1,this.args.falling=!0,this.args.y-=e.args.seatHeight||e.args.height,this.args.ySpeed=-this.args.jumpForce,e.args.ySpeed=0),void(this.region=this.viewport.regionAtPoint(this.x,this.y))}this.args.gSpeedMax;if(this.running?1/0:this.crawling&&1,null!==this.impulseMag&&(this.args.xSpeed=Math.cos(this.impulseDir)*this.impulseMag,this.args.ySpeed=Math.sin(this.impulseDir)*this.impulseMag,this.args.falling=!0,this.impulseMag=null,this.impulseDir=null,this.impulseFal=null),this.args.ignore<1&&(this.args.ignore=0),this.args.ignore>0&&this.args.ignore--,this.args.float>0&&this.args.float--,this.args.falling&&(this.args.landed=!1,this.lastAngles=[]),this.region=this.viewport.regionAtPoint(this.x,this.y),!this.isEffect&&this.args.falling&&this.viewport&&this.updateAirPosition(),this.isEffect||this.args.falling||this.updateGroundPosition(),this.viewport&&!this.removed){var r=this.viewport.tileMap;if(0===this.args.gSpeed&&!this.stayStuck){Math.floor(this.args.width/2);r.getSolid(this.x,this.y+1,this.args.layer)||(this.args.mode=b,this.lastAngles=[])}if(this.args.landed=!0,this.args.x=Math.floor(this.args.x),this.args.y=Math.floor(this.args.y),this.isEffect||this.resolveIntersection(),this.args.falling&&this.args.ySpeed<this.args.ySpeedMax&&(this.args.float||(this.args.ySpeed+=this.args.gravity*(this.region?this.region.args.gravity:1)),this.args.airAngle=this.args.airAngle,this.args.landed=!1),this.processInput(),this.args.falling||this.args.gSpeed?this.args.stopped=0:this.args.stopped++,this.args.falling||this.args.float)this.standingOn=null;else{this.lastAngles.length&&(this.args.groundAngle=this.lastAngles.reduce(function(t,e){return t+e})/this.lastAngles.length);var n=this.getMapSolidAt.apply(this,s(this.groundPoint)),i=Math.floor(this.args.width/2);if(Array.isArray(n)&&n.length){var o=n.filter(function(e){return e.args!==t.args&&e.solid});this.standingOn=o[0]}else if(!n)if(i){var a=s(this.groundPoint);a[0]-=i;var c=this.getMapSolidAt.apply(this,s(a));if(Array.isArray(c)&&c.length){var u=c.filter(function(e){return e.args!==t.args&&e.solid});this.standingOn=u[0]}else if(!c){var l=s(this.groundPoint);l[0]+=i;var f=this.getMapSolidAt.apply(this,s(l));if(Array.isArray(f)&&f.length){var h=f.filter(function(e){return e.args!==t.args&&e.solid});this.standingOn=h[0]}else f||(this.standingOn=null,this.args.falling=!0)}}else this.standingOn=null,this.args.falling=!0}this.standingOn&&this.standingOn.isVehicle?this.args.cameraMode=this.standingOn.args.cameraMode:this.getMapSolidAt(this.x,this.y+48)?this.args.cameraMode="normal":this.onTimeout(350,function(){t.getMapSolidAt(t.x,t.y+48)||(t.args.cameraMode="aerial")}),this.args.colliding=this.colliding}}}},{key:"updateGroundPosition",value:function(){var t=this.args.gSpeedMax;this.running?t=1/0:this.crawling&&(t=1);var e=[0,0];if(this.args.gSpeed)for(var r=Math.abs(this.args.gSpeed),n=Math.ceil(r/64),i=Math.sign(this.args.gSpeed),o=0;o<r&&(e=this.findNextStep(n*i));o+=n){if(e[3]){this.args.moving=!1,this.args.gSpeed=0,1!==this.args.mode&&3!==this.args.mode||(this.args.mode=0,this.lastAngles=[]);break}if(!0===e[2]){switch(this.args.moving=!0,e[0]=n,e[1]=0,this.args.ySpeed=0,this.args.mode){case 0:this.args.xSpeed=this.args.gSpeed,this.args.falling=!0;break;case 2:this.args.xSpeed=-this.args.gSpeed,this.args.falling=!0;break;case 1:Math.abs(this.args.gSpeed)<50?(this.args.mode=0,this.args.y--,this.args.x+=this.args.direction):(this.args.ySpeed=this.args.gSpeed,this.args.xSpeed=0,this.args.ignore=8,this.args.falling=!0);break;case 3:Math.abs(this.args.gSpeed)<50?(this.args.mode=0,this.args.y--,this.args.x+=this.args.direction):(this.args.ySpeed=-this.args.gSpeed,this.args.xSpeed=0,this.args.ignore=8,this.args.falling=!0)}this.args.gSpeed=0;break}if(e[0]||e[1])!e[0]&&!e[1]||this.rotateLock||(this.args.moving=!0,this.args.angle=e[0]?Math.atan(e[1]/e[0]):e[1]>0?Math.PI/2:-Math.PI/2,this.lastAngles.unshift(this.args.angle),this.lastAngles.splice(this.angleAvg));else switch(this.args.moving=!1,this.args.mode){case 0:case 2:this.args.gSpeed=0}if(!this.rotateLock){switch(this.args.mode){case 0:this.args.x+=e[0],this.args.y-=e[1];break;case 2:this.args.x-=e[0],this.args.y+=e[1];break;case 1:this.args.x+=e[1],this.args.y+=e[0];break;case 3:this.args.x-=e[1],this.args.y-=e[0]}if(this.args.angle>Math.PI/4&&this.args.angle<Math.PI/2){switch(this.lastAngles=this.lastAngles.map(function(t){return t-Math.PI/2}),this.args.mode){case 0:this.args.mode=3;break;case 3:this.args.mode=2;break;case 2:this.args.mode=1;break;case 1:this.args.mode=0}this.args.groundAngle-=Math.PI/2}else if(this.args.angle<-Math.PI/4&&this.args.angle>-Math.PI/2){this.args.mode;switch(this.lastAngles=this.lastAngles.map(function(t){return t+Math.PI/2}),this.args.mode){case 0:this.args.mode=1;break;case 3:this.args.mode=0;break;case 2:this.args.mode=3;break;case 1:this.args.mode=2}this.args.groundAngle+=Math.PI/2}}}else if(1===this.args.stopped){var a=this.args.width,s=this.findNextStep(-a),c=this.findNextStep(a);!1===e[0]&&!1===e[1]&&(this.args.falling=!0),!e[0]&&!e[1]||this.rotateLock||(this.args.angle=Math.atan2(c[1]-s[1],2*a+1),this.lastAngles.unshift(this.args.angle),this.lastAngles.splice(this.angleAvg))}!e||!1===e[0]&&!1===e[1]?(this.args.ignore=this.args.ignore||1,this.args.gSpeed=0):Math.abs(this.args.gSpeed)>t&&t!==1/0&&t!==-1/0&&(this.args.gSpeed=t*Math.sign(this.args.gSpeed)),this.willJump&&(this.willJump=!1,this.doJump())}},{key:"updateAirPosition",value:function(){var t=this,e=[this.x,this.y],r=(this.x,this.y,this.viewport.tileMap),n=Math.pow(this.args.xSpeed,2)+Math.pow(this.args.ySpeed,2),i=n?Math.sqrt(n):0,o=this.viewport;if(this.args.flying){var a=1+Math.floor(this.args.width/2)*this.args.direction,c=Math.floor(this.args.height/2),u=this.castRay(Math.abs(this.args.xSpeed)+1,this.args.xSpeed<0?Math.PI:0,[a,-(-1+this.args.height+this.args.yMargin)],function(e,n){return o.actorsAtPoint.apply(o,s(n)).filter(function(e){return e.args!==t.args}).filter(function(e){return e.callCollideHandler(t)}).filter(function(t){return t.isSolid}).length>0?e+1:r.getSolid.apply(r,s(n).concat([t.args.layer]))?e+1:void 0});u&&(this.args.x+=(-1+u)*this.args.direction,this.args.xSpeed=0);var l=this.castRay(Math.abs(this.args.xSpeed)+1,this.args.xSpeed<0?Math.PI:0,[a,this.isVehicle?-this.args.height:-c],function(e,n){return o.actorsAtPoint.apply(o,s(n)).filter(function(e){return e.args!==t.args}).filter(function(e){return e.callCollideHandler(t)}).filter(function(t){return t.isSolid}).length>0?e+1:r.getSolid.apply(r,s(n).concat([t.args.layer]))?e+1:void 0});l&&(this.args.x+=(-1+l)*this.args.direction,this.args.xSpeed=0)}var f=this.castRay(i,this.args.airAngle,function(n,i){return o.actorsAtPoint.apply(o,s(i)).filter(function(e){return e.args!==t.args}).filter(function(e){return e.callCollideHandler(t)}).filter(function(t){return t.isSolid}).length>0?e:r.getSolid.apply(r,s(i).concat([t.args.layer]))?e:void(e=i.map(Math.floor))});this.willJump=!1;var h=!1,p=this.args.flying?this.args.height+this.args.yMargin:1,d=this.castRay(Math.abs(this.args.ySpeed)+p+1,this.upAngle,function(e,n){var i;return!!t.viewport&&((i=t.viewport).actorsAtPoint.apply(i,s(n)).filter(function(e){return e.args!==t.args}).filter(function(e){return e.callCollideHandler(t)}).filter(function(t){return t.solid}).length>0?e:r.getSolid.apply(r,s(n).concat([t.args.layer]))?e:void 0)}),g=this.args.xSpeed,y=this.args.ySpeed;if(this.args.ySpeed<0&&!1!==d){if(this.args.ignore=1,this.args.y-=Math.floor(d-p),this.args.ySpeed=0,h=this.getMapSolidAt(this.x,this.y),Array.isArray(h)&&!this.args.flying){var v=h.filter(function(t){return t.canStick});this.willStick&&v.length&&(this.args.gSpeed=Math.floor(-g),this.args.mode=2,this.args.falling=!1)}else if(this.willStick&&!this.args.flying){var m=this.getMapSolidAt(this.x,this.y-1),w=Array.isArray(m)&&m.filter(function(t){return t.canStick});(!m.length||m.length&&w.length)&&(this.args.gSpeed=Math.floor(-g),this.args.mode=2,this.args.falling=!1)}}else if(!1!==f){this.args.ignore=1;var S=Math.sign(this.args.xSpeed);this.args.xSpeed=0,this.args.ySpeed=0,this.args.x=Math.floor(f[0]),this.args.y=Math.floor(f[1]),(h=this.getMapSolidAt(this.x+S,this.y))?Array.isArray(h)?this.willJump?(this.args.xSpeed*=-1.1,this.args.ySpeed*=-1.1,this.willJump=!1):(h=h.filter(function(e){return e.callCollideHandler(t)})).length&&this.willStick&&(h.filter(function(t){return t.canStick}).length&&(this.args.falling=!1,this.args.gSpeed=Math.floor(y*-S),this.args.mode=S<0?1:3),this.args.ignore=1):this.willJump?(this.args.xSpeed*=-1,this.args.ySpeed*=-1,this.willJump=!1):this.willStick&&(this.args.falling=!1,this.args.gSpeed=Math.floor(y*-S),this.args.mode=S<0?1:3):(this.args.gSpeed=Math.floor(g),this.args.mode=0,this.args.falling=!1)}else this.args.ySpeed>0&&(this.args.mode=b,this.args.gSpeed=Math.floor(g));!1===f&&(this.args.x+=this.args.xSpeed,this.args.y+=this.args.ySpeed,this.args.falling=!0),Math.abs(this.args.xSpeed)>this.args.xSpeedMax&&(this.args.xSpeed=this.args.xSpeedMax*Math.sign(this.args.xSpeed)),Math.abs(this.args.ySpeed)>this.args.ySpeedMax&&(this.args.ySpeed=this.args.ySpeedMax*Math.sign(this.args.ySpeed))}},{key:"callCollideHandler",value:function(t){var e;return this.colliding=!0,this.args.collType="collision-intersect",e=-1,t.y<=this.y-this.args.height?(this.args.collType="collision-top",e=0):t.x<this.x-Math.floor(this.args.width/2)?(this.args.collType="collision-left",e=1):t.x>=this.x+Math.floor(this.args.width/2)?(this.args.collType="collision-right",e=3):t.y>=this.y&&(this.args.collType="collision-bottom",e=2),this.collideA(t,e)}},{key:"resolveIntersection",value:function(){var t=this,e=this.args.airAngle;if(this.args.airAngle>0?e-=Math.PI:e+=Math.PI,this.getMapSolidAt(this.x,this.y)){for(var r,n,i=this.x,o=this.y;;){if(!this.viewport)return;if(!(n=this.getMapSolidAt(i,o)))break;if(r=n,Array.isArray(r)&&!(r=r.filter(function(e){return e.args!==t.args}).filter(function(e){return e.callCollideHandler(t)})).length)break;this.args.xSpeed||this.args.ySpeed?(i+=Math.cos(e),o+=Math.sin(e)):o--}Array.isArray(r)?(r.filter(function(t){return t.canStick}).length||this.getMapSolidAt(i,o+1)?this.args.falling=!1:this.args.falling=!0,this.args.ySpeed=0,this.args.xSpeed=0):r&&(this.args.falling=!1),this.args.x=i,this.args.y=o,this.willJump=!1}}},{key:"processInput",value:function(){if(this.controllable&&this.standingOn&&this.standingOn.isVehicle){var t=this.standingOn;t.xAxis=this.xAxis,t.yAxis=this.yAxis,t.stayStuck=this.stayStuck,t.willStick=this.willStick,this.processInputVehicle(),this.args.direction=t.args.direction,this.args.facing=t.args.facing,this.args.layer=t.args.layer,this.args.mode=t.args.mode,this.args.angle=t.args.angle,this.args.groundAngle=t.args.falling?0:t.args.groundAngle,this.args.cameraMode=t.args.cameraMode}else this.processInputDirect()}},{key:"processInputDirect",value:function(){if(0===this.args.ignore){var t=this.args.gSpeedMax;this.running?t=1/0:this.crawling&&(t=1);var e=this.region?this.region.args.drag:1;if(this.args.falling)this.xAxis&&(this.args.xSpeed+=.3*this.xAxis*e);else if(this.xAxis){var r=this.args.gSpeed;Math.sign(this.xAxis)===Math.sign(this.args.gSpeed)?Math.abs(this.args.gSpeed)<t&&(r+=this.xAxis*this.args.accel*e):r+=this.xAxis*this.args.skidTraction*e,this.args.gSpeed=r}else Math.abs(this.args.gSpeed)<1*this.args.decel/e?this.args.gSpeed=0:this.args.gSpeed>0?this.args.gSpeed-=1*this.args.decel/e:this.args.gSpeed<0&&(this.args.gSpeed+=1*this.args.decel/e);this.xAxis<0&&(this.args.facing="left",this.args.direction=-1),this.xAxis>0&&(this.args.facing="right",this.args.direction=1)}}},{key:"processInputVehicle",value:function(){this.standingOn.processInputDirect()}},{key:"collideA",value:function(t,e){return t.collideB(this),this.solid}},{key:"collideB",value:function(t,e){t.y<=this.y-this.args.height?this.args.collType="collision-top":t.x<this.x-Math.floor(this.args.width/2)?this.args.collType="collision-left":t.x>=this.x+Math.floor(this.args.width/2)?this.args.collType="collision-right":t.y>=this.y&&(this.args.collType="collision-bottom"),this.colliding=!0}},{key:"findNextStep",value:function(t){var e=this;if(this.viewport){for(var r=this.viewport,n=r.tileMap,i=this.maxStep,o=Math.sign(t),a=!1,c=!1,u=0,l=0,f=0;f<Math.abs(t);f++){a=!1,c=!1;var h=void 0,p=(1+f)*o;switch(this.args.mode){case 0:h=[p,1];break;case 3:h=[1,-p];break;case 2:h=[-p,-1];break;case 1:h=[-1,p]}if(!1===(a=this.castRay(i*(1+f),this.downAngle,h,function(t,i){return r.actorsAtPoint.apply(r,s(i)).filter(function(t){return t.args!==e.args}).filter(function(r){return(t<=1||e.args.gSpeed)&&r.callCollideHandler(e)}).filter(function(t){return t.solid}).length>0?t:n.getSolid.apply(n,s(i).concat([e.args.layer]))?t:void 0})))return[!1,!1,!0];var d=Math.abs(l-a);if(Math.abs(d)>i)return[!1,!1,!1,!0];if(0===a){var g=void 0;switch(this.args.mode){case 0:g=[p,0];break;case 3:g=[0,-p];break;case 2:g=[-p,0];break;case 1:g=[0,p]}var y=1+i*(1+f);c=this.castRay(y,this.upAngle,g,function(t,i){if(0===r.actorsAtPoint.apply(r,s(i)).filter(function(t){return t.args!==e.args}).filter(function(r){return(t<=1||e.args.gSpeed)&&r.callCollideHandler(e)}).filter(function(t){return t.solid}).length&&!n.getSolid.apply(n,s(i).concat([e.args.layer])))return t});var v=Math.abs(u-c);if(!1===c)return[!1,!1,!1,!0];if(v>i)return[!1,!1,!1,!0];u=c}else l=a}return!1!==c?[f*o,c,!1]:[f*o,-a,!1]}}},{key:"castRay",value:function(){for(var t=1,e=function(){},r=Math.PI/2,n=[0,0],i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];switch(o.length){case 2:t=o[0],e=o[1];break;case 3:t=o[0],r=o[1],e=o[2];break;case 4:t=o[0],r=o[1],n=o[2],e=o[3]}for(var s=0;s<Math.floor(t);s++){var c=e(s,[this.x+n[0]+s*Math.cos(r),this.y+n[1]+s*Math.sin(r)]);if(void 0!==c)return c}return!1}},{key:"doJump",value:function(){if(!this.args.ignore&&!this.args.falling&&this.args.landed&&!this.args.float){var t=this.region?this.region.args.drag:1,e=this.args.jumpForce*t;this.running?e*=1.5:this.crawling&&(e*=.5);var r=this.args.mode;this.args.ignore=1,this.args.landed=!1,this.args.falling=!0;var n=this.args.angle||0;switch(r){case 0:this.args.xSpeed=this.args.gSpeed*Math.sin(n+Math.PI/2),this.args.ySpeed=this.args.gSpeed*Math.cos(n+Math.PI/2),this.args.xSpeed+=e*Math.cos(n+Math.PI/2),this.args.ySpeed-=e*Math.sin(n+Math.PI/2);break;case 1:this.args.xSpeed=-this.args.gSpeed*Math.cos(n+Math.PI/2),this.args.ySpeed=this.args.gSpeed*Math.sin(n+Math.PI/2),this.args.xSpeed-=e*Math.sin(n-Math.PI/2),this.args.ySpeed-=e*Math.cos(n-Math.PI/2);break;case 2:this.args.xSpeed=-this.args.gSpeed*Math.sin(n+Math.PI/2),this.args.ySpeed=-this.args.gSpeed*Math.cos(n+Math.PI/2),this.args.xSpeed-=e*Math.cos(n+Math.PI/2),this.args.ySpeed+=e*Math.sin(n+Math.PI/2);break;case 3:this.args.xSpeed=this.args.gSpeed*Math.cos(n+Math.PI/2),this.args.ySpeed=-this.args.gSpeed*Math.sin(n+Math.PI/2),this.args.xSpeed+=e*Math.sin(n-Math.PI/2),this.args.ySpeed+=e*Math.cos(n-Math.PI/2)}Math.abs(this.args.xSpeed)<.001&&(this.args.xSpeed=0),Math.abs(this.args.ySpeed)<.001&&(this.args.ySpeed=0),this.args.mode=b}}},{key:"sleep",value:function(){}},{key:"wakeUp",value:function(){}},{key:"impulse",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.impulseMag=t,this.impulseDir=e,this.impulseFal=r}},{key:"rad2deg",value:function(t){var e=180/Math.PI*t;return e>0?Math.floor(10*e)/10:Math.ceil(10*e)/10}},{key:"roundAngle",value:function(t,e){return e/=2,Math.round(t/(Math.PI/e))*Math.PI/e}},{key:"scanVerticalEdge",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=this.viewport.tileMap;return this.castRay(this.args.height+1,Math.PI/2,[e*this.args.width/2,-this.args.height],function(e,n){var i;if((i=t.viewport).actorsAtPoint.apply(i,s(n)).filter(function(e){return e.args!==t.args}).length||r.getSolid.apply(r,s(n).concat([t.args.layer])))return e})}},{key:"rotatePoint",value:function(){}},{key:"rotatePoint",value:function(t,e){return[t*Math.cos(this.realAngle)-e*Math.sin(this.realAngle),e*Math.cos(this.realAngle)+t*Math.sin(this.realAngle)]}},{key:"getMapSolidAt",value:function(t,e){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.viewport){if(n){var i=this.viewport.actorsAtPoint(t,e).filter(function(t){return t.args!==r.args}).filter(function(t){return t.solid});if(i.length>0)return i}return this.viewport.tileMap.getSolid(t,e,this.args.layer)}}},{key:"command_0",value:function(){this.args.falling||this.willJump||this.willJump||(this.willJump=!0)}},{key:"realAngle",get:function(){if(this.args.falling)return Math.PI;var t,e=this.args.groundAngle;switch(this.args.mode){case 0:t=-e-Math.PI;break;case 1:t=-e-Math.PI/2;break;case 2:t=-e;break;case 3:t=-e+Math.PI/2}return t}},{key:"downAngle",get:function(){switch(this.args.mode){case 0:return Math.PI/2;case 3:return 0;case 2:return-Math.PI/2;case 1:return Math.PI}}},{key:"upAngle",get:function(){switch(this.args.mode){case 0:return-Math.PI/2;case 3:return Math.PI;case 2:return Math.PI/2;case 1:return 0}}},{key:"leftAngle",get:function(){switch(this.args.mode){case 0:return Math.PI;case 3:return-Math.PI/2;case 2:return 0;case 1:return Math.PI/2}}},{key:"rightAngle",get:function(){switch(this.args.mode){case 0:return 0;case 3:return Math.PI/2;case 2:return Math.PI;case 1:return-Math.PI/2}}},{key:"groundPoint",get:function(){switch(this.args.mode){case 0:return[this.x+0,this.y+1];case 3:return[this.x+1,this.y+0];case 2:return[this.x+0,this.y-1];case 1:return[this.x-1,this.y+0]}}},{key:"canStick",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"isVehicle",get:function(){return!1}},{key:"solid",get:function(){return!1}},{key:"x",get:function(){return this.args.x}},{key:"y",get:function(){return this.args.y}},{key:"point",get:function(){return[this.args.x,this.args.y]}},{key:"rotateLock",get:function(){return!1}},{key:"controllable",get:function(){return!1}}]),r}();t.PointActor=m}),require.register("actor/Projectile.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Projectile=void 0;var i=e("./PointActor"),o=e("../actor/Explosion");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-projectile",t.args.width=8,t.args.height=8,t.args.float=-1,t.removeTimer=null,t}return e=h,(r=[{key:"update",value:function(){var t=this;this.removed||(s(l(h.prototype),"update",this).call(this),this.args.xSpeed||this.args.ySpeed||this.explode(),this.removeTimer||(this.removeTimer=this.onTimeout(2e3,function(){return t.explode()})))}},{key:"collideA",value:function(t){return!(t===this.args.owner||t instanceof h||t instanceof o.Explosion)&&(this.viewport&&this.explode(),!1)}},{key:"collideB",value:function(t){return!(t===this.args.owner||t instanceof h||t instanceof o.Explosion)&&(this.viewport&&this.explode(),!1)}},{key:"explode",value:function(){this.viewport&&(this.viewport.actors.remove(this),this.remove())}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&a(e.prototype,r),n&&a(e,n),h}();t.Projectile=f}),require.register("actor/QuestionBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionBlock=void 0;var i=e("./PointActor"),o=e("./Monitor");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(d,i.PointActor);var e,r,n,p=u(d);function d(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(l(t=p.call.apply(p,[this].concat(r))),"maxBounce",4),h(l(t),"template",'<div\n\t\tclass = "point-actor [[type]] [[collType]]"\n\t\tstyle = "\n\t\t\tdisplay:[[display]];\n\t\t\t--angle:[[angle]];\n\t\t\t--airAngle:[[airAngle]];\n\t\t\t--display-angle:[[_angle]];\n\t\t\t--height:[[height]];\n\t\t\t--width:[[width]];\n\t\t\t--x:[[x]];\n\t\t\t--y:[[y]];\n\t\t"\n\t\tdata-colliding = "[[colliding]]"\n\t\tdata-falling   = "[[falling]]"\n\t\tdata-facing    = "[[facing]]"\n\t\tdata-angle     = "[[angle|rad2deg]]"\n\t\tdata-mode      = "[[mode]]"\n\t\tdata-empty     = "[[empty]]"\n\t><div class = "sprite"></div></div>'),t.args.type="actor-item actor-question-block",t.args.width=32,t.args.height=32,t.args.float=-1,t.initY=null,t.empty=!1,t}return e=d,(r=[{key:"collideA",value:function(t,e){var r=this;if(s(f(d.prototype),"collideA",this).call(this,t),null===this.initY&&(this.initY=this.y),2===e){var n=Math.abs(t.args.ySpeed);if(t.args.falling=!0,t.args.ySpeed>0?t.args.ySpeed+=this.args.ySpeed:(this.args.y-=n,t.args.y+=n),this.args.ySpeed>0&&this.args.ySpeed>t.args.ySpeed&&(t.args.ySpeed=Math.abs(t.args.ySpeed),t.args.y+=this.args.ySpeed),this.args.ySpeed<0&&(this.args.ySpeed=-Math.abs(this.args.ySpeed)),this.args.ySpeed)return!0;var i=this.maxBounce,a=2===e?-Math.abs(t.args.ySpeed):t.args.ySpeed;Math.abs(a)>i&&(a=i*Math.sign(a)),this.args.ySpeed=a,t.args.ySpeed=-t.args.ySpeed}if(2===e&&!this.args.empty&&!this.args.empty){var c=new o.Monitor({x:this.x,y:this.y-128});this.viewport.actors.add(c),c.onRemove(function(){return r.args.empty=!1}),this.args.empty=!0}return!0}},{key:"update",value:function(){null!==this.initY&&(this.initY>this.y?this.args.ySpeed+=.75:this.initY<this.y&&(this.args.ySpeed-=.75),Math.abs(this.args.y-this.initY)<1&&Math.abs(this.args.ySpeed)<1&&(this.args.ySpeed=0,this.args.y=this.initY)),this.args.ySpeed*=.9,this.args.ySpeed=Math.floor(100*this.args.ySpeed)/100,this.args.y=Math.round(this.args.y);var t=this.maxBounce;Math.abs(this.args.ySpeed)>t&&(this.args.ySpeed=t*Math.sign(this.args.ySpeed)),s(f(d.prototype),"update",this).call(this)}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),d}();t.QuestionBlock=p}),require.register("actor/Region.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Region=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(r,i.PointActor);var e=c(r);function r(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).args.type="region region-water",t.args.width=t.args.width||32,t.args.height=t.args.height||32,t.args.gravity=.1,t.args.drag=.2,t}return a(r,null,[{key:"fromDef",value:function(t){var e=u(l(r),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e}}]),a(r,[{key:"update",value:function(){this.originalHeight||(this.originalHeight=this.args.height);this.args.height=Math.floor(Math.abs((this.originalHeight-144)*Math.sin(Date.now()/6e4))+144)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}]),r}();t.Region=f}),require.register("actor/Ring.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Ring=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-ring",t.args.width=32,t.args.height=32,t.args.float=-1,t.args.gone=!1,t}return e=f,(r=[{key:"update",value:function(){a(u(f.prototype),"update",this).call(this),this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/ring-collect.wav"),this.sample.volume=.15+-.05*Math.random())}},{key:"collideA",value:function(t){var e=this;if(a(u(f.prototype),"collideA",this).call(this,t),!this.args.gone){if(this.args.type="actor-item actor-ring collected",!this.args.gone){this.viewport.args.audio&&this.sample&&this.sample.play(),this.onTimeout(60,function(){e.args.type="actor-item actor-ring collected gone"}),this.onTimeout(120,function(){e.viewport.actors.remove(e),e.remove()});var r=this.x,n=this.y,i=this.viewport;setTimeout(function(){i.spawn.add({time:Date.now()+3500,object:new f({x:r,y:n})})},7500),t.args.owner?t.args.owner.args.rings+=1:t.occupant?t.occupant.args.rings+=1:t.args.rings+=1}this.args.gone=!0}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Ring=l}),require.register("actor/Seymour.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Seymour=void 0;var i=e("./PointActor");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-seymour",t.args.accel=.15,t.args.decel=.3,t.args.gSpeedMax=30,t.args.jumpForce=12,t.args.gravity=.6,t.args.width=48,t.args.height=55,t}return e=f,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","standing"):n>.25*i?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}a(u(f.prototype),"update",this).call(this)}else a(u(f.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Seymour=l}),require.register("actor/Sonic.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Sonic=void 0;var i=e("./PointActor");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-sonic",t.args.accel=.18,t.args.decel=.7,t.args.skidTraction=.5,t.args.gSpeedMax=30,t.args.jumpForce=15,t.args.gravity=.7,t.args.width=16,t.args.height=40,t}return e=f,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.box.setAttribute("data-animation","jumping");else{var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","skidding"):n>i/2?this.box.setAttribute("data-animation","running"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}a(u(f.prototype),"update",this).call(this)}else a(u(f.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Sonic=l}),require.register("actor/Spring.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Spring=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(r,i.PointActor);var e=c(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return t=e.call.apply(e,[this].concat(s)),n=u(t),o='<div\n\t\tclass = "point-actor actor-item [[type]] [[collType]]"\n\t\tstyle = "\n\t\t\tdisplay:[[display]];\n\t\t\t--angle:[[angle]];\n\t\t\t--airAngle:[[airAngle]];\n\t\t\t--ground-angle:[[groundAngle]];\n\t\t\t--height:[[height]];\n\t\t\t--width:[[width]];\n\t\t\t--x:[[x]];\n\t\t\t--y:[[y]];\n\t\t"\n\t\tdata-colliding = "[[colliding]]"\n\t\tdata-falling   = "[[falling]]"\n\t\tdata-facing    = "[[facing]]"\n\t\tdata-angle     = "[[angle|rad2deg]]"\n\t\tdata-mode      = "[[mode]]"\n\t>\n\t\t<div\n\t\t\tdata-color = "[[color]]"\n\t\t\tdata-type  = "[[base]]"\n\t\t\tclass      = "spring-pad"\n\t\t\tstyle = "--color:[[color]]deg"\n\t\t></div>\n\t\t<div class = "sprite"></div>\n\t</div>',(i="template")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t.args.type="actor-item actor-spring",t.args.width=32,t.args.height=32,t.args.color=t.args.color||0,t.args.float=-1,t}return a(r,null,[{key:"fromDef",value:function(t){var e=l(f(r),"fromDef",this).call(this,t);return e.args.angle=Number(e.args.angle),e}}]),a(r,[{key:"update",value:function(){l(f(r.prototype),"update",this).call(this)}},{key:"collideA",value:function(t){return l(f(r.prototype),"collideA",this).call(this,t),t.args.falling=!0,t.impulse(this.args.power,this.args.angle,!0),!1}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}]),r}();t.Spring=h}),require.register("actor/StarPost.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.StarPost=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=e("./Monitor"),s=e("../actor/Projectile");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(d,i.PointActor);var e,r,n,p=f(d);function d(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).args.type="actor-item actor-star-post",t.args.width=16,t.args.height=48,t.args.active=!1,t.spinning=!1,t}return e=d,(r=[{key:"update",value:function(){u(h(d.prototype),"update",this).call(this),this.viewport&&this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/starpost-active.wav"),this.sample.volume=.5+.025*Math.random())}},{key:"onRendered",value:function(){this.sprite=this.findTag("div.sprite"),this.box=this.findTag("div"),this.headBox=new o.Tag('<div class = "star-post-head-box">'),this.head=new o.Tag('<div class = "star-post-head">'),this.headBox.appendChild(this.head.node),this.box.appendChild(this.headBox.node)}},{key:"collideA",value:function(t){var e=this;if(u(h(d.prototype),"collideA",this).call(this,t),this.box)if(this.args.active)t instanceof s.Projectile&&!this.spinning&&(this.box.setAttribute("data-direction",t.args.direction),this.box.setAttribute("data-spin","false"),this.viewport.args.audio&&this.sample&&(this.sample.currentTime=0,this.sample.play()),this.onTimeout(0,function(){return e.box.setAttribute("data-spin","true")}),this.spinning=!0,this.onTimeout(600,function(){return e.spinning=!1}));else{this.box.setAttribute("data-direction",t.args.direction),this.box.setAttribute("data-active","true"),this.box.setAttribute("data-spin","true"),this.viewport.args.audio&&this.sample&&this.sample.play();var r=new a.Monitor({x:this.x-10,y:this.y-48,xSpeed:5*(Math.sign(t.args.gSpeed)||1),ySpeed:-5});this.viewport.actors.add(r),this.args.active=!0,this.spinning=!0,this.onTimeout(600,function(){return e.spinning=!1})}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&c(e.prototype,r),n&&c(e,n),d}();t.StarPost=p}),require.register("actor/Tails.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Tails=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-tails",t.args.accel=.18,t.args.decel=.7,t.args.gSpeedMax=27,t.args.jumpForce=15,t.args.gravity=.7,t.args.skidTraction=.5,t.args.width=16,t.args.height=32,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.tails=new o.Tag('<div class = "tails-tails">'),this.sprite.appendChild(this.tails.node)}},{key:"update",value:function(){var t=this.args.falling;if(this.viewport.args.audio&&!this.flyingSound&&(this.flyingSound=new Audio("/Sonic/tails-flying.wav"),this.flyingSound.volume=.35+-.2*Math.random(),this.flyingSound.loop=!0),this.flyingSound.paused||(this.flyingSound.volume=.35+-.2*Math.random()),this.flyingSound.currentTime>.2&&(this.flyingSound.currentTime=0),this.box){if(t)this.args.flying?this.yAxis>0?(this.box.setAttribute("data-animation","jumping"),this.args.ySpeed=this.args.jumpForce):this.box.setAttribute("data-animation","flying"):this.args.falling&&(this.flyingSound.pause(),this.box.setAttribute("data-animation","jumping"));else{this.flyingSound.pause();var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","skidding"):n>i/2?this.box.setAttribute("data-animation","running"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}0==this.args.tailFlyCoolDown?this.args.ySpeed>5&&(this.flyingSound.pause(),this.args.flying=!1):this.args.tailFlyCoolDown>0&&this.args.tailFlyCoolDown--,s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"command_0",value:function(){if(!this.args.falling)return this.args.tailFlyCoolDown=15,void s(l(h.prototype),"command_0",this).call(this);this.args.tailFlyCoolDown>0||this.args.ySpeed>1&&(this.args.flying||this.flyingSound.play(),this.args.flying=!0,0==this.args.tailFlyCoolDown&&(this.args.tailFlyCoolDown=7),this.args.ySpeed=-1,this.args.float=8)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),h}();t.Tails=f}),require.register("actor/TextActor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TextActor=void 0;var i=e("./PointActor"),o=e("../ui/CharacterString");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(l,i.PointActor);var e,r,n,u=c(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=u.call.apply(u,[this].concat(r))).args.type="actor-item actor-text-actor",t.args.float=-1,t}return e=l,(r=[{key:"update",value:function(){this.sprite||(this.sprite=this.findTag("div.sprite"),this.text=new o.CharacterString({value:"Click a character to select."}),this.text.render(this.sprite))}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),l}();t.TextActor=l}),require.register("actor/Window.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Window=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="actor-item actor-window",t.args.width=64,t.args.height=160,t.args.float=-1,t}return e=u,(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),u}();t.Window=u}),require.register("debug/LineDump.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LineDump=void 0;var i=e("curvature/base/View");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.View);var e=a(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return t=e.call.apply(e,[this].concat(c)),n=s(t),o='<div class = "line-dump" style = "--x:[[x]];--y:[[y]];--length:[[len]];--angle:[[angle]]">\n\t\t<div class = "line" style = "border-color:[[color]]"></div>\n\t</div>',(i="template")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t.args.x=t.args.x||0,t.args.y=t.args.y||0,t}return r}();t.LineDump=u}),require.register("debug/PointDump.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PointDump=void 0;var i=e("curvature/base/View");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.View);var e=a(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return t=e.call.apply(e,[this].concat(c)),n=s(t),o='<div class = "point-dump">\n\t\t<div class = "point" style = "--color:[[color]]">[[x]], [[y]]</div>\n\t</div>',(i="template")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t.args.x=t.args.x||0,t.args.y=t.args.y||0,t}return r}();t.PointDump=u}),require.register("initialize.js",function(t,e,r){"use strict";var n=e("curvature/base/Tag"),i=(e("./tileMap/TileMap"),new(e("./viewport/Viewport").Viewport));document.addEventListener("DOMContentLoaded",function(){var t=Date.now();Promise.all([i.tileMap.ready]).then(function(){i.render(document.body);var e=new n.Tag(document.body),r=100;setInterval(function(){return e.style({"background-position":"".concat(r++/25,"px top,")+" -".concat(r/23,"px 63%,")+" -".concat(r/10,"px 63%,")+" ".concat(r++/20,"px 63%,")+" -10% bottom"})},9),i.update();!function e(){i.update(),i.args.fps=1e3/(Date.now()-t),t=Date.now(),requestAnimationFrame(e)}()})})}),require.register("legacy/Actor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Actor=void 0;var i=e("curvature/base/View"),o=(e("../tileMap/TileMap"),e("../debug/PointDump"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(p,i.View);var r,n,l,h=c(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return f(u(t=h.call.apply(h,[this].concat(n))),"speed",15),f(u(t),"template",e("./actor.html")),t.world=null,t.x=92,t.y=1024,t.width=64,t.height=64,t.boxWidth=64,t.boxHeight=64,t.directions=16,t.state="standing",t.gSpeed=0,t.gSpeedMax=40,t.xSpeed=0,t.ySpeed=0,t.angle=0,t.maxGravity=48,t.gravity=0,t.slopeFactor=.01,t.falling=!0,t.sensors={top:!1,bottom:!1,left:!1,right:!1},t.mode=t.args.mode=0,t.modes={floor:0,leftWall:1,ceiling:2,rightWall:3},t.animationClasses={},t.currentClasses=null,t.pdL=new o.PointDump({color:"red"}),t.pdR=new o.PointDump({color:"green"}),t.args.debugs=[t.pdL,t.pdR],t}return r=p,(n=[{key:"destroy",value:function(){}},{key:"update",value:function(){if(this.tags.actor){var t=this.gSpeed;this.args.animspeed=Math.floor((this.gSpeedMax-Math.abs(t))/12),this.args.animspeed<1&&(this.args.animspeed=1);var e=Math.round(1e3*this.angle)/1e3;if(this.falling?(this.falling||this.jumped)&&(this.args.state="jumping"):(e>Math.PI/4&&e<2*Math.PI/4&&(this.mode===this.modes.floor?this.args.mode=this.mode=this.modes.leftWall:this.mode===this.modes.leftWall?this.args.mode=this.mode=this.modes.ceiling:this.mode===this.modes.ceiling?this.args.mode=this.mode=this.modes.rightWall:this.mode===this.modes.rightWall&&(this.args.mode=this.mode=this.modes.floor)),e<-Math.PI/4&&e>-2*Math.PI/4&&(this.mode===this.modes.floor?this.args.mode=this.mode=this.modes.rightWall:this.mode===this.modes.rightWall?this.args.mode=this.mode=this.modes.ceiling:this.mode===this.modes.ceiling?this.args.mode=this.mode=this.modes.leftWall:this.mode===this.modes.leftWall&&(this.args.mode=this.mode=this.modes.floor)),Math.abs(t)>this.gSpeedMax/2?this.args.state="running":Math.abs(t)>0?this.args.state="walking":this.args.state="standing",this.args.facing=t>0?"facing-right":"facing-left"),this.falling?this.mode==this.modes.floor?this.ySpeed++:this.mode==this.modes.ceiling?this.ySpeed--:this.mode==this.modes.leftWall?this.xSpeed--:this.mode==this.modes.rightWall&&this.xSpeed++:this.jumped||(this.xSpeed=0,this.ySpeed=0),this.x+=this.xSpeed,this.ySpeed&&(this.y+=this.ySpeed>0?1:-1),t)for(var r=Math.abs(t),n=r>8?8:r,i=0;i<n;i++)this.iteratePosition(Math.floor(t/n));else this.iteratePosition(0);this.ySpeed>32&&(this.ySpeed=32),this.ySpeed<-32&&(this.ySpeed=-32),this.xSpeed>32&&(this.xSpeed=32),this.xSpeed<-32&&(this.xSpeed=-32),this.tags.actor.style({"--x":Math.floor(this.x),"--y":Math.floor(this.y)}),this.mode===this.modes.floor?this.tags.actor.style({"--angle":this.angle}):this.mode===this.modes.leftWall?this.tags.actor.style({"--angle":this.angle+Math.PI/2*1}):this.mode===this.modes.ceiling?this.tags.actor.style({"--angle":this.angle+Math.PI/2*2}):this.mode===this.modes.rightWall&&this.tags.actor.style({"--angle":this.angle+Math.PI/2*3}),this.jumped&&(this.jumped=!1)}}},{key:"iteratePosition",value:function(t){var e,r,n,i,o=Math.sin(this.angle),a=Math.cos(this.angle),s=this.center,c=(this.top,this.bottom),u=(this.left,this.right);this.mode==this.modes.floor||this.mode==this.modes.ceiling?(e=u-s[0],s[1]):this.mode!=this.modes.leftWall&&this.mode!=this.modes.rightWall||(e=u-s[1],s[0]),r=this.left-e*o+.5*e,n=this.right-e*o-.5*e,i=Math.abs(n-r);var l,f,h,p,d=this.viewport.tileMap,g=0,y=0,v=!1,b=!1,m=(this.falling,this.height),w=[[-m,0],[-m,m]];t:for(var S in w)for(g=w[S][0];g<w[S][1];){if(this.mode==this.modes.floor?(l=r,f=c+g):this.mode==this.modes.ceiling?(l=r,f=c-g):this.mode==this.modes.leftWall?(l=c-g,f=r):this.mode==this.modes.rightWall&&(l=c+g,f=r),v=d.getSolid(l,f)){if(0!==g)break t;break}g++}for(var O in w)for(y=w[O][0];y<w[O][1]&&(this.mode==this.modes.floor?(h=n,p=c+y):this.mode==this.modes.ceiling?(h=n,p=c-y):this.mode==this.modes.leftWall?(h=c-y,p=n):this.mode==this.modes.rightWall&&(h=c+y,p=n),!(b=d.getSolid(h,p)));)y++;if(this.pdL.args.x=l,this.pdL.args.y=f,this.pdR.args.x=h,this.pdR.args.y=p,this.angle=Math.atan((y-g)/i),!this.falling){var k=(g+y)/2;this.mode===this.modes.floor?(this.x+=t*a,this.y+=t*o):this.mode===this.modes.rightWall?(this.x+=t*o,this.y-=t*a):this.mode===this.modes.ceiling?(this.x-=t*a,this.y-=t*o):this.mode===this.modes.leftWall&&(this.x-=t*o,this.y+=t*a),v&&b&&g<=0&&y<=0&&(this.mode==this.modes.floor?this.y+=Math.ceil(k):this.mode==this.modes.ceiling?this.y-=Math.ceil(k):this.mode==this.modes.leftWall?this.x-=k:this.mode==this.modes.rightWall&&(this.x+=k))}this.falling=g>0&&y>0}},{key:"isColliding",value:function(t){}},{key:"animate",value:function(t){}},{key:"animate",value:function(){this.animationClasses[animation]&&this.currentClasses!=this.animationClasses[animation]&&(this.currentClasses.map(function(t){this.tags.sprite.removeClass(t)}),this.animationClasses[animation].map(function(t){this.tags.sprite.addClass(t)}),this.currentClasses=this.animationClasses[animation])}},{key:"roundAngle",value:function(t,e){return 360*"Math.round"((t=Math.round(t*(180/Math.PI)))/(360/e))/e*(Math.PI/180)}},{key:"goLeft",value:function(){this.gSpeed>0&&(this.gSpeed=0),this.gSpeed>-this.gSpeedMax&&this.gSpeed--}},{key:"goRight",value:function(){this.gSpeed<0&&(this.gSpeed=0),this.gSpeed<this.gSpeedMax&&this.gSpeed++}},{key:"slowDown",value:function(){Math.abs(this.gSpeed)>32?this.gSpeed=.95*this.gSpeed:this.gSpeed=.75*this.gSpeed,Math.abs(this.gSpeed)<=.1&&(this.gSpeed=0)}},{key:"jump",value:function(){var t;this.falling||(this.falling=!0,this.jumped=!0,this.mode=this.args.mode=this.modes.floor,this.mode===this.modes.floor?t=this.angle:this.mode===this.modes.leftWall?t=this.angle+Math.PI/2*1:this.mode===this.modes.ceiling?t=this.angle+Math.PI/2*2:this.mode===this.modes.rightWall&&(t=this.angle+Math.PI/2*3),this.angle=0,this.ySpeed=20*-Math.cos(t),this.xSpeed=20*Math.sin(t),this.mode!==this.modes.leftWall&&this.mode!==this.modes.rightWall||(this.gSpeed=0))}},{key:"center",get:function(){return[this.x+this.boxWidth/2,this.y+this.boxHeight/2]}},{key:"left",get:function(){return this.mode==this.modes.floor?this.center[0]-this.width/2:this.mode==this.modes.ceiling?this.center[0]+this.width/2:this.mode==this.modes.leftWall?this.center[1]-this.width/2:this.mode==this.modes.rightWall?this.center[1]+this.width/2:void 0}},{key:"right",get:function(){return this.mode==this.modes.floor?this.center[0]+this.width/2:this.mode==this.modes.ceiling?this.center[0]-this.width/2:this.mode==this.modes.leftWall?this.center[1]+this.width/2:this.mode==this.modes.rightWall?this.center[1]-this.width/2:void 0}},{key:"top",get:function(){return this.mode==this.modes.floor?this.center[1]-Math.floor(this.height/2):this.mode==this.modes.ceiling?this.center[1]+Math.floor(this.height/2):this.mode==this.modes.leftWall?this.center[0]+Math.floor(this.height/2):this.mode==this.modes.rightWall?this.center[0]-Math.floor(this.height/2):void 0}},{key:"bottom",get:function(){return this.mode==this.modes.floor?this.center[1]+Math.floor(this.height/2):this.mode==this.modes.ceiling?this.center[1]-Math.floor(this.height/2):this.mode==this.modes.leftWall?this.center[0]-Math.floor(this.height/2):this.mode==this.modes.rightWall?this.center[0]+Math.floor(this.height/2):void 0}}])&&a(r.prototype,n),l&&a(r,l),p}();t.Actor=h}),require.register("legacy/Walker.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Walker=void 0;var i=e("./Actor");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Actor);var e=a(r);function r(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),e.apply(this,arguments)}return r}();t.Walker=c}),require.register("legacy/actor.html",function(t,e,r){r.exports='<div class = "actor knuckles [[state]] [[facing]]" cv-ref = "actor" data-mode = "[[mode]]" style = "--animspeed:[[animspeed]]">\n\t<div class = "sprite" cv-ref = "sprite" ></div>\n</div>\n<div cv-each = "debugs:debug">[[debug]]</div>\n'}),require.register("tileMap/TileMap.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileMap=void 0;var n=e("curvature/base/Tag");function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.heightMask=null,this.tileNumberCache={},this.heightMaskCache={},this.solidCache={},this.tileLayers=[],this.objectLayers=[];this.ready=new Promise(function(t){fetch("/map/pixel-hill-zone.json").then(function(t){return t.json()}).then(function(e){i.mapData=e;var r=e.layers||[];i.objectLayers=r.filter(function(t){return"objectLayers"===t.type}),i.tileLayers=r.filter(function(t){return"tilelayer"===t.type});var o=new Image;o.src="/map/shapes.png",o.addEventListener("load",function(e){i.width=o.width,i.height=o.height;var r=new n.Tag("<canvas>");r.width=o.width,r.height=o.height,r.getContext("2d").drawImage(o,0,0,i.width,i.height),i.heightMask=r,t()})})})}var e,r,o;return e=t,(r=[{key:"coordsToTile",value:function(t,e){var r=this.mapData.tilewidth;return[Math.floor(t/r),Math.floor(e/r)]}},{key:"getTileNumber",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=[t,e,r].join("::"),i=this.tileNumberCache,o=this.tileLayers,a=this.mapData;if(n in i)return i[n];if(!o[r])return i[n]=!1;if(t>=a.width||e>=a.height||t<0||e<0)return i[n]=0===r&&1;var s=e*a.width+t;return s in o[r].data&&0!==o[r].data[s]?i[n]=o[r].data[s]-1:i[n]=!1}},{key:"getObjectDefs",value:function(){return this.mapData.layers.filter(function(t){return"objectgroup"===t.type}).map(function(t){return t.objects}).flat()}},{key:"getTile",value:function(t){var e=this.blockSize,r=0,n=0;if(t){var i=Math.ceil(this.width/e);r=t%i,n=Math.floor(t/i)}return[r,n]}},{key:"getSolid",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.heightMaskCache,o=this.heightMask,a=[t,e,r].join("::"),s=this.solidCache,c=this.mapData;if(a in s)return s[a];var u=c.tilewidth;if(0!==r&&this.getSolid(t,e,0))return s[a]=!0;var l=this.coordsToTile(t,e),f=this.getTileNumber.apply(this,i(l).concat([r]));0===f&&(s[a]=!1),1===f&&(s[a]=!0);var h=this.getTile(f).map(function(t){return t*u}),p=Math.floor(Number(t)%u),d=Math.floor(Number(e)%u),g=[t,e,f].join("::");if(g in n)return s[a]=n[g];var y=h[0]+p,v=h[1]+d;n[g]=!1;var b=o.getContext("2d").getImageData(y,v,1,1).data;return 0===b[0]&&0===b[1]&&0===b[2]&&255===b[3]&&(n[g]=!0),s[a]=n[g]}},{key:"blockSize",get:function(){return this.mapData.tilewidth}}])&&a(e.prototype,r),o&&a(e,o),t}();t.TileMap=s}),require.register("ui/CharacterString.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterString=void 0;var i=e("curvature/base/View");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.View);var e=a(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return t=e.call.apply(e,[this].concat(c)),n=s(t),o='<div class = "hud-character-string [[hide]] [[color]]" cv-each = "chars:char:c" style = "--scale:[[scale]];"><span\n\t\t\t\tclass = "hud-character"\n\t\t\t\tdata-type  = "[[char.type]]"\n\t\t\t\tdata-value = "[[char.pos]]"\n\t\t\t\tdata-index = "[[c]]"\n\t\t\t\tstyle      = "--value:[[char.pos]];--index:[[c]];--length:[[chars.length]];"\n\t\t\t>[[char.original]]</span></div>',(i="template")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t.args.chars=[],t.args.scale=t.args.scale||1,t.args.bindTo(["value"],function(e){Math.abs(e)>t.args.high?t.args.color="red":Math.abs(e)>t.args.med?t.args.color="orange":Math.abs(e)>t.args.low?t.args.color="yellow":t.args.color="";var r=String(e).split("").map(function(e,r){var n=e,i="number";if(" "===e||Number(e)!=e)switch(e){case"-":e=11,i="number";break;case":":e=10,i="number";break;case".":e=12,i="number";break;case"/":e=13,i="number";break;case" ":e=14,i="number";break;default:e=String(e).toLowerCase().charCodeAt(0)-97,i="letter"}return t.args.chars[r]?(t.args.chars[r].original=n,t.args.chars[r].type=i,t.args.chars[r].pos=e,t.args.chars[r]):{pos:e,type:i,original:n}});Object.assign(t.args.chars,r),t.args.chars.splice(r.length)}),t}return r}();t.CharacterString=u}),require.register("ui/HudFrame.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.HudFrame=void 0;var i=e("curvature/base/View");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.View);var e=a(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return t=e.call.apply(e,[this].concat(c)),n=s(t),o='<div class = "hud-frame [[type]] [[alert]]">\n\t\t<div class = "hud-value">[[value]]</div>\n\t</div>',(i="template")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t}return r}();t.HudFrame=u}),require.register("viewport/Layer.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Layer=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Tag"),a=e("curvature/base/Bag");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,i.View);var r,n,f,h=u(p);function p(t,r){var n,i,o,s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),n=h.call(this,t,r),i=l(n),o="template",s=e("./layer.html"),o in i?Object.defineProperty(i,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[o]=s,n.args.width=320,n.args.height=200,n.args.blockSize=32,n.x=0,n.y=0,n.args.offsetX=0,n.args.offsetY=0,n.args.layerId=n.args.layerId,Object.defineProperty(l(n),"blocksXY",{value:{}}),Object.defineProperty(l(n),"blocks",{value:new a.Bag}),Object.defineProperty(l(n),"offsets",{value:new Map}),n.args.blocks=n.blocks.list,n}return r=p,(n=[{key:"update",value:function(t){for(var e=this.args.blockSize,r=Math.ceil(this.args.width/e),n=Math.ceil(this.args.height/e),i=this.blocksXY,a=this.blocks,s=this.offsets,c=(this.args.offsetX,this.args.offsetY,this.args.layerId),u=0;u<=r;u++)for(var l=u-Math.ceil(this.x/e),f=0;f<=n;f++){var h=[u,f].join("::"),p=void 0;if(i[h])p=i[h];else{i[h]=new o.Tag("<div>"),(p=i[h]).style({width:e+"px",height:e+"px"});var d=e*u,g=e*f;p.style({transform:"translate(".concat(d,"px, ").concat(g,"px)"),"background-image":"url(/map/shapes.png)",position:"absolute",left:0,top:0}),a.add(p)}var y=f-Math.ceil(this.y/e),v=t.getTileNumber(l,y,c),b=[];c&&!1===v?(b[0]=-1,b[1]=-1):b=t.getTile(v);var m=s.get(p),w=b[0]*e*-1+"px "+b[1]*e*-1+"px";m!==w&&p.style({"background-position":w}),s.set(p,w)}}}])&&s(r.prototype,n),f&&s(r,f),p}();t.Layer=h}),require.register("viewport/Viewport.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;var i=e("curvature/base/Bindable"),o=e("curvature/base/Bag"),a=(e("curvature/base/Tag"),e("curvature/base/View")),s=e("curvature/input/Keyboard"),c=e("../tileMap/TileMap"),u=e("../actor/QuestionBlock"),l=(e("../actor/BrokenMonitor"),e("../actor/MarbleBlock")),f=e("../actor/LayerSwitch"),h=(e("../actor/Explosion"),e("../actor/StarPost")),p=e("../actor/Emerald"),d=e("../actor/Window"),g=(e("../actor/Monitor"),e("../actor/Spring")),y=e("../actor/Ring"),v=e("../actor/Coin"),b=(e("../actor/PointActor"),e("../actor/Projectile")),m=e("../actor/TextActor"),w=e("../actor/EggMobile"),S=e("../actor/DrillCar"),O=e("../actor/NuclearSuperball"),k=e("../actor/Eggman"),A=e("../actor/Eggrobo"),x=e("../actor/MechaSonic"),_=e("../actor/Sonic"),P=e("../actor/Tails"),j=e("../actor/Knuckles"),M=e("../actor/Seymour"),R=e("../actor/Region"),T=e("../ui/CharacterString"),C=e("../ui/HudFrame"),E=e("./Layer");function D(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return B(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function N(t,e){return(N=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=F(t);if(e){var o=F(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return q(t)}(this,r)}}function q(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function F(t){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var W={player:O.NuclearSuperball,spring:g.Spring,"layer-switch":f.LayerSwitch,"star-post":h.StarPost,"q-block":u.QuestionBlock,projectile:b.Projectile,"marble-block":l.MarbleBlock,"drill-car":S.DrillCar,"egg-mobile":w.EggMobile,sonic:_.Sonic,tails:P.Tails,knuckles:j.Knuckles,"mecha-sonic":x.MechaSonic,eggman:k.Eggman,eggrobo:A.Eggrobo,seymour:M.Seymour,window:d.Window,emerald:p.Emerald,region:R.Region,ring:y.Ring,coin:v.Coin},V=(Symbol("collision-cells-near"),Symbol("collision-cell")),K=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&N(t,e)}(f,a.View);var r,n,u,l=L(f);function f(t,r){var n,i,a,s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),n=l.call(this,t,r),i=q(n),a="template",s=e("./viewport.html"),a in i?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s,n.sprites=new o.Bag,n.tileMap=new c.TileMap,n.world=null,n.particles=new o.Bag,n.args.particles=n.particles.list,n.args.currentActor="",n.args.yOffsetTarget=.75,n.args.yOffset=.5,n.args.status=new T.CharacterString({value:"",scale:2}),n.args.focusMe=new T.CharacterString({value:"",scale:2}),n.args.labelX=new T.CharacterString({value:"x pos: "}),n.args.labelY=new T.CharacterString({value:"y pos: "}),n.args.labelGround=new T.CharacterString({value:"Grounded: "}),n.args.labelAngle=new T.CharacterString({value:"Gnd theta: "}),n.args.labelGSpeed=new T.CharacterString({value:"speed: "}),n.args.labelXSpeed=new T.CharacterString({value:"X air spd: "}),n.args.labelYSpeed=new T.CharacterString({value:"Y air spd: "}),n.args.labelMode=new T.CharacterString({value:"Mode: "}),n.args.labelFps=new T.CharacterString({value:"FPS: "}),n.args.labelAirAngle=new T.CharacterString({value:"Air theta: "}),n.args.xPos=new T.CharacterString({value:0}),n.args.yPos=new T.CharacterString({value:0}),n.args.gSpeed=new T.CharacterString({value:0,high:199,med:99,low:49}),n.args.ground=new T.CharacterString({value:""}),n.args.xSpeed=new T.CharacterString({value:0}),n.args.ySpeed=new T.CharacterString({value:0}),n.args.mode=new T.CharacterString({value:0}),n.args.angle=new T.CharacterString({value:0}),n.args.airAngle=new T.CharacterString({value:0}),n.args.fpsSprite=new T.CharacterString({value:0}),n.args.bindTo("fps",function(t){return n.args.fpsSprite.args.value=Number(t).toFixed(2)}),n.rings=new T.CharacterString({value:0}),n.coins=new T.CharacterString({value:0}),n.emeralds=new T.CharacterString({value:"0/7"}),n.args.emeralds=new C.HudFrame({value:n.emeralds,type:"emerald-frame"}),n.args.timer=new C.HudFrame({value:new T.CharacterString({value:"00:00.000"})}),n.args.rings=new C.HudFrame({value:n.rings,type:"ring-frame"}),n.args.coins=new C.HudFrame({value:n.coins,type:"coin-frame"}),n.args.blockSize=32,n.args.populated=!1,n.args.willStick=!1,n.args.stayStuck=!1,n.args.willStick=!0,n.args.stayStuck=!0,n.args.width=448,n.args.height=256,n.args.scale=2,n.args.x=n.args.x||0,n.args.y=n.args.y||0,n.args.layers=[],n.args.animation="",n.spawn=new Set,n.regions=new Set,n.actors=new o.Bag(function(t,e,r){r==o.Bag.ITEM_ADDED?(t.viewport=q(n),n.setColCell(t),t instanceof R.Region&&n.regions.add(t)):r==o.Bag.ITEM_REMOVED&&(t.viewport=null,t[V]&&t[V].delete(t),t instanceof R.Region&&n.regions.delete(t),delete t[V])}),n.blocks=new o.Bag,n.args.blocks=n.blocks.list,n.args.actors=n.actors.list,n.args.bindTo("willStick",function(t){t&&(n.args.stayStuck=!0)}),n.args.bindTo("stayStuck",function(t){t||(n.args.willStick=!1)}),n.listen(window,"gamepadconnected",function(t){return n.padConnected(t)}),n.colCellCache={},n.colCellDiv=n.args.width>n.args.height?.75*n.args.width:.75*n.args.height,n.colCells={},n.actorPointCache=new Map,n.startTime=null,n.args.audio=!0,n.nextControl=!1,n.args.controllable={"character select":null},n.updateStarted=new Set,n.updateEnded=new Set,n.updated=new Set,n}return r=f,(n=[{key:"fullscreen",value:function(){var t=this;this.args.focusMe.args.hide="hide",this.initScale=this.args.scale,this.tags.viewport.requestFullscreen().then(function(e){t.onTimeout(100,function(){var e=window.innerHeight/t.args.height,r=window.innerWidth/t.args.width;t.args.scale=e>r?e:r,t.args.fullscreen="fullscreen",t.args.status.args.value=" hit escape to revert. ",t.args.status.args.hide="",t.onTimeout(2500,function(){t.args.focusMe.args.hide="",t.args.status.args.hide="hide"})})})}},{key:"onAttached",value:function(t){var e=this;this.listen(document,"fullscreenchange",function(t){document.fullscreenElement||(e.args.scale=e.initScale,e.args.fullscreen="")}),this.tags.frame.style({"--width":this.args.width,"--height":this.args.height,"--scale":this.args.scale}),this.update(),this.startTime||(this.startTime=Date.now()+4750),this.args.paused=!0,this.args.status.args.hide="hide",this.args.animation="start",this.onTimeout(250,function(){e.args.animation="",e.onTimeout(750,function(){e.args.animation="opening",e.tags.viewport.focus(),e.onTimeout(750,function(){e.args.animation="opening2",e.tags.viewport.focus(),e.update(),e.onTimeout(1500,function(){e.args.animation="closing",e.tags.viewport.focus(),e.args.focusMe.args.value=" Click here to enable keyboard control. ",e.args.status.args.hide="",e.onTimeout(750,function(){e.args.animation="closed",e.tags.viewport.focus()}),e.onTimeout(500,function(){e.args.paused=!1})})})})}),this.listen(document.body,"click",function(t){t.target===document.body&&e.tags.viewport.focus()}),this.args.scale=this.args.scale||1;var r=s.Keyboard.get();r.listening=!0,r.focusElement=this.tags.viewport.node}},{key:"takeKeyboardInput",value:function(){var t=s.Keyboard.get();t.update(),t.getKey("Shift")>0?(this.controlActor.running=!1,this.controlActor.crawling=!0):t.getKey("Control")>0&&(this.controlActor.running=!0,this.controlActor.crawling=!1),t.getKey("ArrowLeft")>0||t.getKey("a")>0?this.controlActor.xAxis=-1:t.getKey("ArrowRight")>0||t.getKey("d")>0?this.controlActor.xAxis=1:t.getKey("ArrowUp")>0||t.getKey("w")>0?1===this.controlActor.args.mode?this.controlActor.xAxis=-1:3===this.controlActor.args.mode&&(this.controlActor.xAxis=1):(t.getKey("ArrowDown")>0||t.getKey("s")>0)&&(1===this.controlActor.args.mode?this.controlActor.xAxis=1:3===this.controlActor.args.mode&&(this.controlActor.xAxis=-1)),(t.getKey("ArrowUp")>0||t.getKey("w")>0)&&(this.controlActor.yAxis=-1),(t.getKey("ArrowDown")>0||t.getKey("s")>0)&&(this.controlActor.yAxis=1),t.getKey("ArrowUp")<=0&&t.getKey("ArrowDown"),t.getKey(" ")>0&&this.controlActor.command_0&&this.controlActor.command_0(),t.getKey("z")>0&&this.controlActor.command_2&&this.controlActor.command_2()}},{key:"takeGamepadInput",value:function(){if(this.gamepad)for(var t=navigator.getGamepads(),e=0;e<t.length;e++){var r=t.item(e);r&&(r.axes[0]&&Math.abs(r.axes[0])>.3?this.controlActor.xAxis=r.axes[0]:this.controlActor.xAxis=0,r.axes[1]&&Math.abs(r.axes[1])>.3?1===this.controlActor.args.mode?this.controlActor.xAxis=r.axes[1]:3===this.controlActor.args.mode?this.controlActor.xAxis=r.axes[1]:this.controlActor.yAxis=r.axes[1]:this.controlActor.yAxis=0,r.buttons[14].pressed?this.controlActor.xAxis=-1:r.buttons[15].pressed?this.controlActor.xAxis=1:r.buttons[12].pressed?(1===this.controlActor.args.mode?this.controlActor.xAxis=-1:3===this.controlActor.args.mode&&(this.controlActor.xAxis=1),this.controlActor.yAxis=-1):r.buttons[13].pressed&&(1===this.controlActor.args.mode?this.controlActor.xAxis=1:3===this.controlActor.args.mode&&(this.controlActor.xAxis=-1),this.controlActor.yAxis=1),r.buttons[12].pressed?this.controlActor.yAxis=-1:r.buttons[13].pressed&&(this.controlActor.yAxis=1),r.buttons[5].pressed?(this.controlActor.running=!1,this.controlActor.crawling=!0):(r.buttons[1].pressed||r.buttons[4].pressed)&&(this.controlActor.running=!0,this.controlActor.crawling=!1),r.buttons[0].pressed&&this.controlActor.command_0&&this.controlActor.command_0(),r.buttons[2].pressed&&this.controlActor.command_2&&this.controlActor.command_2())}}},{key:"moveCamera",value:function(){var t=15;this.controlActor.args.falling?(this.args.yOffsetTarget=.5,t=25):2===this.controlActor.args.mode?"normal"==this.controlActor.args.cameraMode?(this.args.yOffsetTarget=.25,t=10):(this.args.yOffsetTarget=.5,t=10):this.controlActor.args.mode?this.args.yOffsetTarget=.5:"normal"==this.controlActor.args.cameraMode?(this.args.yOffsetTarget=.75,t=10):(this.args.yOffsetTarget=.5,t=20),this.args.x=-this.controlActor.x+.5*this.args.width,this.args.y=-this.controlActor.y+this.args.height*this.args.yOffset,Math.abs(this.args.yOffsetTarget-this.args.yOffset)<.01?this.args.yOffset=this.args.yOffsetTarget:this.args.yOffset+=(this.args.yOffsetTarget-this.args.yOffset)/t,this.args.x>96&&(this.args.x=96),this.args.y>96&&(this.args.y=96);var e=-32*this.tileMap.mapData.width+this.args.width-96,r=-32*this.tileMap.mapData.height+this.args.height-96;this.args.x<e&&(this.args.x=e),this.args.y<r&&(this.args.y=r)}},{key:"updateBackground",value:function(){for(var t=this.tileMap.tileLayers.length,e=0;e<t;e++)this.args.layers[e]||(this.args.layers[e]=new E.Layer({layerId:e}),this.args.layers[e].args.height=this.args.height,this.args.layers[e].args.width=this.args.width),this.args.layers[e].x=this.args.x,this.args.layers[e].y=this.args.y,this.args.layers[e].update(this.tileMap);this.tags.content.style({"--x":Math.round(this.args.x),"--y":Math.round(this.args.y)});var r=this.args.x<0?Math.round(this.args.x%this.args.blockSize):(-this.args.blockSize+Math.round(this.args.x%this.args.blockSize))%this.args.blockSize,n=this.args.y<0?Math.round(this.args.y%this.args.blockSize):(-this.args.blockSize+Math.round(this.args.y%this.args.blockSize))%this.args.blockSize;this.tags.background.style({transform:"translate(calc(1px * ".concat(r,"), calc(1px * ").concat(n,"))")}),this.tags.frame.style({"--width":this.args.width,"--height":this.args.height,"--scale":this.args.scale})}},{key:"populateMap",value:function(){if(!this.args.populated){this.args.populated=!0;var t=this.tileMap.getObjectDefs();for(var e in t){var r=t[e],n=r.type;if(W[n]){var i=W[n].fromDef(r);this.actors.add(i),(i.controllable||i.args.controllable)&&(this.args.controllable[r.name]=i)}}this.actors.add(new m.TextActor({x:1250,y:1800}))}}},{key:"spawnActors",value:function(){var t,e=this,r=window.requestIdleCallback||window.requestAnimationFrame,n=D(this.spawn.values());try{var i=function(){var n=t.value;n.time<Date.now()&&(e.spawn.delete(n),r(function(){return e.actors.add(n.object)}))};for(n.s();!(t=n.n()).done;)i()}catch(t){n.e(t)}finally{n.f()}}},{key:"actorUpdateStart",value:function(t){for(var e in t){var r,n=D(t[e].values());try{for(n.s();!(r=n.n()).done;){var i=r.value;this.updateStarted.has(i)||(i.args.display="initial",i.updateStart(),this.updateStarted.add(i))}}catch(t){n.e(t)}finally{n.f()}}}},{key:"actorUpdate",value:function(t){for(var e in t){var r,n=D(t[e].values());try{for(n.s();!(r=n.n()).done;){var i=r.value;this.updated.has(i)||(i.update(),this.setColCell(i),this.updated.add(i))}}catch(t){n.e(t)}finally{n.f()}}}},{key:"actorUpdateEnd",value:function(t){var e=this.args.width,r=this.args.height,n=this.args.x,i=this.args.y;for(var o in t){var a,s=D(t[o].values());try{for(s.s();!(a=s.n()).done;){var c=a.value;if(!this.updateEnded.has(c)){c.updateEnd();var u=c.x+n-e/2,l=c.y+i-r/2;Math.abs(u)>e?c.args.display="":Math.abs(l)>r?c.args.display="":c.args.display="initial",this.updateEnded.add(c)}}}catch(t){s.e(t)}finally{s.f()}}}},{key:"update",value:function(){var t=(Date.now()-this.startTime)/1e3,e=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),r=String((Math.abs(t)%60).toFixed(2)).padStart(5,"0"),n=t<0?"-":"";if(n&&(e=Number(e)),this.args.populated||this.populateMap(),this.args.timer.args.value.args.value="".concat(n).concat(e,":").concat(r),this.actorPointCache.clear(),this.args.paused)this.tags.frame.style({"--scale":this.args.scale,"--width":this.args.width});else{var i,o=D(this.regions.values());try{for(o.s();!(i=o.n()).done;){var a=i.value;a.updateStart(),this.updateStarted.add(this.controlActor),a.update(),this.updated.add(this.controlActor),a.updateEnd(),this.updateEnded.add(this.controlActor)}}catch(t){o.e(t)}finally{o.f()}var s=this.actors.list;this.controlActor=this.controlActor||s[0],this.args.maxSpeed||(this.args.maxSpeed=this.controlActor.args.gSpeedMax),this.controlActor.args.gSpeedMax=this.args.maxSpeed,this.controlActor.willStick=!!this.args.willStick,this.controlActor.stayStuck=!!this.args.stayStuck,this.controlActor.crawling=!1,this.controlActor.running=!1,this.controlActor.xAxis=0,this.controlActor.yAxis=0,this.updateStarted.clear(),this.updated.clear(),this.updateEnded.clear(),this.takeGamepadInput(),this.takeKeyboardInput(),this.controlActor.updateStart(),this.updateStarted.add(this.controlActor);var c=this.getNearbyColCells(this.controlActor);this.controlActor.args.display="initial",this.actorUpdateStart(c),this.controlActor.update(),this.updated.add(this.controlActor),this.actorUpdate(c),this.moveCamera(),this.updateBackground(),this.rings.args.value!=this.controlActor.args.rings?this.rings.args.color="yellow":this.rings.args.color="",this.coins.args.value!=this.controlActor.args.coins?this.coins.args.color="yellow":this.coins.args.color="",this.emeralds.args.value[0]!=this.controlActor.args.emeralds?this.emeralds.args.color="yellow":this.emeralds.args.color="",this.rings.args.value=this.controlActor.args.rings,this.coins.args.value=this.controlActor.args.coins,this.emeralds.args.value="".concat(this.controlActor.args.emeralds,"/7"),this.args.hasRings=!!this.controlActor.args.rings,this.args.hasCoins=!!this.controlActor.args.coins,this.args.hasEmeralds=!!this.controlActor.args.emeralds,this.args.xPos.args.value=Math.round(this.controlActor.x),this.args.yPos.args.value=Math.round(this.controlActor.y),this.args.ground.args.value=this.controlActor.args.landed,this.args.gSpeed.args.value=this.controlActor.args.gSpeed.toFixed(2),this.args.xSpeed.args.value=Math.round(this.controlActor.args.xSpeed),this.args.ySpeed.args.value=Math.round(this.controlActor.args.ySpeed),this.args.angle.args.value=(Math.round(1e3*this.controlActor.args.angle)/1e3).toFixed(3),this.args.airAngle.args.value=(Math.round(1e3*this.controlActor.args.airAngle)/1e3).toFixed(3);this.args.mode.args.value=["FLOOR","L-WALL","CEILING","R-WALL"][Math.floor(this.controlActor.args.mode)]||Math.floor(this.controlActor.args.mode),this.controlActor.updateEnd(),this.updateEnded.add(this.controlActor),this.actorUpdateEnd(c),this.spawnActors(),this.nextControl&&(this.controlActor=this.nextControl,this.args.maxSpeed=null,this.nextControl=null)}}},{key:"regionAtPoint",value:function(t,e){var r,n=D(this.regions.values());try{for(n.s();!(r=n.n()).done;){var i=r.value,o=i.args.x,a=i.args.y,s=i.args.width,c=i.args.height;Math.floor(s/2);if(t>=o&&o+s>t&&a>=e&&e>a-c)return i}}catch(t){n.e(t)}finally{n.f()}}},{key:"actorsAtPoint",value:function(t,e){var r=[t,e].join("::"),n=this.actorPointCache;if(n.has(r))return n.get(r);var i=[];return this.getNearbyColCells({x:t,y:e}).map(function(r){var n,o=D(r.values());try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.removed)r.delete(a);else{var s=a.args.x,c=a.args.y,u=a.args.width,l=a.args.height,f=Math.floor(u/2);t>=-f+s&&-f+s+u>t&&c>=e&&e>c-l&&i.push(a)}}}catch(t){o.e(t)}finally{o.f()}}),n.set(r,i),i}},{key:"screenBox",value:function(){return[this.camera.x-Math.floor(this.width/2),this.camera.y-Math.floor(this.height/2),this.camera.x+Math.ceil(this.width/2),this.camera.y+Math.ceil(this.height/2)]}},{key:"padConnected",value:function(t){this.gamepad=t.gamepad}},{key:"getColCell",value:function(t){var e=this.colCellDiv,r=this.colCells,n=Math.floor(t.x/e),i=Math.floor(t.y/e);return r[n]=r[n]||{},r[n][i]=r[n][i]||new Set,r[n][i]}},{key:"setColCell",value:function(t){var e=this.getColCell(t),r=t[V];return r&&r!==e&&r.delete(t),t[V]=e,t[V].add(t),e}},{key:"getNearbyColCells",value:function(t){var e=this.colCellDiv,r=Math.floor(t.x/e),n=Math.floor(t.y/e),i="".concat(r,"::").concat(n);if(this.colCellCache[i])return this.colCellCache[i].filter(function(t){return t.size});var o=e;return this.colCellCache[i]=[this.getColCell({x:t.x-o,y:t.y-o}),this.getColCell({x:t.x-o,y:t.y}),this.getColCell({x:t.x-o,y:t.y+o}),this.getColCell({x:t.x,y:t.y-o}),this.getColCell({x:t.x,y:t.y}),this.getColCell({x:t.x,y:t.y+o}),this.getColCell({x:t.x+o,y:t.y-o}),this.getColCell({x:t.x+o,y:t.y}),this.getColCell({x:t.x+o,y:t.y+o})],this.colCellCache[i].filter(function(t){return t.size})}},{key:"change",value:function(t){if(t.target.value&&this.args.controllable[t.target.value]){var e=this.args.controllable[t.target.value];this.nextControl=i.Bindable.make(e),this.tags.viewport.focus()}}}])&&I(r.prototype,n),u&&I(r,u),f}();t.Viewport=K}),require.register("viewport/layer.html",function(t,e,r){r.exports='<div class = "viewport-background" cv-each = "blocks:block:b" cv-ref = "background" data-layer = "[[layerId]]">[[block]]</div>\n'}),require.register("viewport/viewport.html",function(t,e,r){r.exports='<div class = "viewport-frame" cv-ref = "frame">\n\t<div class = "viewport-header">\n\t\t<span class = "sean-icon"></span>\n\t\t<h1>Pixel Physics</h1>\n\t</div>\n\t<div class = "viewport [[fullscreen]]" cv-ref = "viewport" tabindex="0">\n\n\t\t<div class = "viewport-zoom">\n\t\t\t<div cv-ref = "background" class = "viewport-bg-layers" cv-each = "layers:layer">[[layer]]</div>\n\n\t\t\t<div  cv-ref = "content" class = "viewport-content">\n\n\t\t\t\t<div class = "viewport-actors" cv-each = "actors:actor:a">\t[[actor]]\n\t\t\t\t</div>\n\n\t\t\t\t<div cv-ref = "particles" class = "viewport-particles" cv-each = "particles:particle:p">\n\t\t\t\t\t[[particle]]\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class = "viewport-double-zoom">\n\t\t\t<div class = "hud">\n\t\t\t\t<table>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelGround]]</td>\n\t\t\t\t\t\t<td>[[ground]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelMode]]</td>\n\t\t\t\t\t\t<td>[[mode]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelX]]</td>\n\t\t\t\t\t\t<td>[[xPos]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelY]]</td>\n\t\t\t\t\t\t<td>[[yPos]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelXSpeed]]</td>\n\t\t\t\t\t\t<td>[[xSpeed]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelYSpeed]]</td>\n\t\t\t\t\t\t<td>[[ySpeed]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelAirAngle]]</td>\n\t\t\t\t\t\t<td>[[airAngle]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelAngle]]</td>\n\t\t\t\t\t\t<td>[[angle]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelFps]]</td>\n\t\t\t\t\t\t<td>[[fpsSprite]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelGSpeed]]</td>\n\t\t\t\t\t\t<td>[[gSpeed]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t\t<div class = "titlecard [[animation]]">\n\n\t\t\t\t<div class = "titlecard-field"></div>\n\n\t\t\t\t<div class = "titlecard-bottom-border">\n\t\t\t\t\t<div class = "titlecard-border-text">SEAN MORRIS</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class = "titlecard-left-border">\n\t\t\t\t\t<div class = "titlecard-border-shadow"></div>\n\t\t\t\t\t<div class = "titlecard-border-color"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class = "titlecard-title">\n\t\t\t\t\t<div class = "titlecard-title-box">\n\n\t\t\t\t\t\t<div class = "titlecard-title-line-1">\n\t\t\t\t\t\t\tPIXEL HILL\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class = "titlecard-title-line-2">\n\t\t\t\t\t\t\tZONE<div class = "titlecard-title-number">\n\t\t\t\t\t\t\t\t1\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t\t<div class = "focus-me">\n\t\t\t\t<div class = "status-message">[[focusMe]]</div>\n\t\t\t</div>\n\t\t\t<div class = "status-message">[[status]]</div>\n\n\t\t</div>\n\n\t\t<span class = "hud-top-left">\n\t\t\t<div class = "timer">[[timer]]</div>\n\t\t\t<div cv-if = "hasRings">\n\t\t\t\t[[rings]]\n\t\t\t</div>\n\t\t\t<div cv-if = "hasCoins">\n\t\t\t\t[[coins]]\n\t\t\t</div>\n\t\t\t<div cv-if = "hasEmeralds">\n\t\t\t\t[[emeralds]]\n\t\t\t</div>\n\t\t</span>\n\t</div>\n\n\t<div class = "viewport-caption">\n\t\t<div>\n\t\t\t<div>\n\t\t\t\t<div class = "right">\n\t\t\t\t\t<label>\n\t\t\t\t\t\t<button cv-on = "click:fullscreen(event)">fullscreen</button>\n\t\t\t\t\t\t<small><small>[esc to revert]</small></small>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\n\n\t\t\t\t<span class = "button-index">\n\t\t\t\t\t<span class = "arrow button arrow-west"></span>\n\t\t\t\t\t/ <span class = "arrow button arrow-east"></span>\n\t\t\t\t\t/ <b>wasd</b>\n\t\t\t\t\t- move\n\t\t\t\t</span>\n\n\t\t\t\t<span class = "button-index">\n\t\t\t\t\t<span class = "button ps-x"></span>\n\t\t\t\t\t/ <span class = "button xb-a"></span>\n\t\t\t\t\t/ <b>space</b>\n\t\t\t\t\t- jump\n\t\t\t\t</span>\n\n\t\t\t\t<span class = "button-index">\n\t\t\t\t\t<span class = "button ps-r1"></span>\n\t\t\t\t\t/ <span class = "button xb-rb"></span>\n\t\t\t\t\t/ <b>shift</b>\n\t\t\t\t\t- brakes (hold)\n\t\t\t\t</span>\n\n\t\t\t\t<span class = "button-index">\n\t\t\t\t\t<span class = "button ps-o"></span>\n\t\t\t\t\t/ <span class = "button xb-b"></span>\n\t\t\t\t\t/ <b>ctrl</b>\n\t\t\t\t\t- <span class= "alert">ignore speed limit (hold)</span>\n\t\t\t\t</span>\n\n\t\t\t\t<span class = "button-index">\n\t\t\t\t\t<span class = "button ps-l1"></span>\n\t\t\t\t\t/ <span class = "button xb-lb"></span>\n\t\t\t\t\t/ <b>ctrl</b>\n\t\t\t\t\t- <span class= "alert">ignore speed limit (hold)</span>\n\t\t\t\t</span>\n\n\n\t\t\t\t<p>\n\t\t\t\t\t<a class = "github" cv-link = "https://github.com/seanmorris/pixel-physics">\n\t\t\t\t\t\t<span class = "github-icon"></span>\n\t\t\t\t\t\tview the project on github\n\t\t\t\t\t</a>\n\t\t\t\t</p>\n\n\t\t\t</div>\n\n\t\t\t<div class = "right">\n\n\x3c!-- \t\t\t\t<label>\n\t\t\t\t\t<small>player character:</small>\n\t\t\t\t\t<select>\n\t\t\t\t\t\t<option value = "nuke-ball">nuclear superball</option>\n\t\t\t\t\t\t<option value = "sonic">sonic</option>\n\t\t\t\t\t\t<option value = "tails">tails</option>\n\t\t\t\t\t\t<option value = "knuckles">knuckles</option>\n\t\t\t\t\t\t<option value = "amy-rose">amy rose</option>\n\t\t\t\t\t\t<option value = "charmy bee">charmy bee</option>\n\t\t\t\t\t\t<option value = "mario">mario</option>\n\t\t\t\t\t\t<option value = "luigi">luigi</option>\n\t\t\t\t\t\t<option value = "luigi">samus</option>\n\t\t\t\t\t\t<option value = "luigi">metal sonic</option>\n\t\t\t\t\t</select>\n\t\t\t\t</label> --\x3e\n\n\t\t\t\t<label>\n\t\t\t\t\t<select cv-each = "controllable:obj:name" cv-ref = "currentActor" cv-on = "change(event)">\n\t\t\t\t\t\t<option value = "[[name]]">[[name]]</option>\n\t\t\t\t\t</select>\n\t\t\t\t</label>\n\n\n\t\t\t\t<label>\n\t\t\t\t\t<span>enable audio</span>\n\t\t\t\t\t<input type = "checkbox" cv-bind = "audio" value = "1" />\n\t\t\t\t</label>\n\n\t\t\t\t<label>\n\t\t\t\t\t<span>player can stop on walls</span>\n\t\t\t\t\t<input type = "checkbox" cv-bind = "stayStuck" value = "1" />\n\t\t\t\t</label>\n\n\t\t\t\t<label>\n\t\t\t\t\t<span>jumps can stick to walls</span>\n\t\t\t\t\t<input type = "checkbox" cv-bind = "willStick" value = "1" />\n\t\t\t\t\t<br />\n\t\t\t\t</label>\n\n\t\t\t\t<small><small>(requires "stop on walls")</small></small>\n\n\t\t\t\t<hr />\n\n\t\t\t\t<label>\n\t\t\t\t\t<span>speed limit:</span>\n\t\t\t\t\t<form>\n\t\t\t\t\t\t<input type = "number" cv-bind = "maxSpeed" min = "1" />\n\t\t\t\t\t</form>\n\t\t\t\t</label>\n\n\t\t\t\t<label>\n\t\t\t\t\t<span>scale:</span>\n\t\t\t\t\t<form>\n\t\t\t\t\t\t<input type = "number" cv-bind = "scale" min = "1" max = "5" />\n\t\t\t\t\t</form>\n\t\t\t\t</label>\n\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n</div>\n\n\n<div class = "sun"></div>\n<div class = "clouds-a"></div>\n<div class = "clouds-b"></div>\n'}),require.register("___globals___",function(t,e,r){})}(),require("___globals___");
